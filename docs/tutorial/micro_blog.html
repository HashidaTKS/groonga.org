<!DOCTYPE html>

<html lang="en">
  <head>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7532323-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-7532323-1');
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.10. Let’s create micro-blog &#8212; Groonga v11.0.7 documentation</title>
    <link rel="stylesheet" type="text/css" href="../static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../static/groonga.css" />
    
    <script data-url_root="../" id="documentation_options" src="../static/documentation_options.js"></script>
    <script src="../static/jquery.js"></script>
    <script src="../static/underscore.js"></script>
    <script src="../static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.11. Query expansion" href="query_expansion.html" />
    <link rel="prev" title="4.9. Additional information about lexicon for full text search" href="lexicon.html" /> 
      <meta property="fb:page_id" content="201193596592346" /><!-- groonga -->
    <meta property="fb:admins" content="664204556" /><!-- kouhei.sutou -->
    <meta property="og:type" content="product" />
    <meta property="og:image" content="http://groonga.org/images/logos/groonga-icon-full-size.png" />
    <meta property="og:site_name" content="groonga" />

    <link rel="stylesheet" href="/css/sphinx.css" type="text/css" />
  </head>
  <body>
    <div id="fb-root"></div>

<div class="header">
  <h1 class="title">
    <a id="top-link" href="../../">
      <span class="project">groonga</span>
      <span class="separator">-</span>
      <span class="description">An open-source fulltext search engine and column store.</span>
    </a>
  </h1>

      <div class="facebook-buttons">
      <fb:like href="http://www.facebook.com/pages/groonga/201193596592346"
               layout="standard"
               width="290"></fb:like>
    </div>
    <div class="other-language-links">

    <ul>
      <li><a href="../../ja/docs/tutorial/micro_blog.html">日本語</a></li>
    </ul>
  </div>
</div>
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="query_expansion.html" title="4.11. Query expansion"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lexicon.html" title="4.9. Additional information about lexicon for full text search"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Groonga v11.0.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../tutorial.html" accesskey="U"><span class="section-number">4. </span>Tutorial</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">4.10. </span>Let’s create micro-blog</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="let-s-create-micro-blog">
<h1><span class="section-number">4.10. </span>Let’s create micro-blog<a class="headerlink" href="#let-s-create-micro-blog" title="Permalink to this headline">¶</a></h1>
<p>Let’s create micro-blog with full text search by Groonga.
Micro-blog is one of the broadcast medium in the forms of blog. It is mainly used to post small messages like a Twitter.</p>
<div class="section" id="create-a-table">
<h2><span class="section-number">4.10.1. </span>Create a table<a class="headerlink" href="#create-a-table" title="Permalink to this headline">¶</a></h2>
<p>Let’s create table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">Users</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_HASH_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span>
<span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_HASH_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span>
<span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">HashTags</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_HASH_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span>
<span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">Bigram</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_PAT_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">ShortText</span> <span class="o">--</span><span class="n">default_tokenizer</span> <span class="n">TokenBigram</span> <span class="o">--</span><span class="n">normalizer</span> <span class="n">NormalizerAuto</span>
<span class="n">table_create</span> <span class="o">--</span><span class="n">name</span> <span class="n">GeoIndex</span> <span class="o">--</span><span class="n">flags</span> <span class="n">TABLE_PAT_KEY</span> <span class="o">--</span><span class="n">key_type</span> <span class="n">WGS84GeoPoint</span>

<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">name</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">follower</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_VECTOR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">favorites</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_VECTOR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Comments</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">location</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">WGS84GeoPoint</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">location_str</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">description</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">name</span> <span class="n">followee</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span> <span class="o">--</span><span class="n">source</span> <span class="n">follower</span>

<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">comment</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">ShortText</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">last_modified</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Time</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">replied_to</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Comments</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">replied_users</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_VECTOR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">hash_tags</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_VECTOR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">HashTags</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">location</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">WGS84GeoPoint</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">posted_by</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_SCALAR</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">name</span> <span class="n">favorited_by</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span> <span class="o">--</span><span class="n">source</span> <span class="n">favorites</span>

<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">HashTags</span> <span class="o">--</span><span class="n">name</span> <span class="n">hash_index</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">source</span> <span class="n">hash_tags</span>

<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Bigram</span> <span class="o">--</span><span class="n">name</span> <span class="n">users_index</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span><span class="o">|</span><span class="n">WITH_SECTION</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span> <span class="o">--</span><span class="n">source</span> <span class="n">name</span><span class="p">,</span><span class="n">location_str</span><span class="p">,</span><span class="n">description</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">Bigram</span> <span class="o">--</span><span class="n">name</span> <span class="n">comment_index</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span><span class="o">|</span><span class="n">WITH_POSITION</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">source</span> <span class="n">comment</span>

<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">GeoIndex</span> <span class="o">--</span><span class="n">name</span> <span class="n">users_location</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Users</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span> <span class="o">--</span><span class="n">source</span> <span class="n">location</span>
<span class="n">column_create</span> <span class="o">--</span><span class="n">table</span> <span class="n">GeoIndex</span> <span class="o">--</span><span class="n">name</span> <span class="n">comments_location</span> <span class="o">--</span><span class="nb">type</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">flags</span> <span class="n">COLUMN_INDEX</span> <span class="o">--</span><span class="n">source</span> <span class="n">location</span>
</pre></div>
</div>
<div class="section" id="users-table">
<h3><span class="section-number">4.10.1.1. </span>Users table<a class="headerlink" href="#users-table" title="Permalink to this headline">¶</a></h3>
<p>This is the table which stores user information.
It stores name of user, profile, list of follower and so on.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">_key</span></code></dt><dd><p>User ID</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">name</span></code></dt><dd><p>User name</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">follower</span></code></dt><dd><p>List of following users</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">favorites</span></code></dt><dd><p>List of favorite comments</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">location</span></code></dt><dd><p>Current location of user (geolocation)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">location_str</span></code></dt><dd><p>Current location of user (string)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">description</span></code></dt><dd><p>User profile</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">followee</span></code></dt><dd><p>Indexes for <code class="docutils literal notranslate"><span class="pre">follower</span></code> column in <code class="docutils literal notranslate"><span class="pre">Users</span></code> table.
With this indexes, you can search users who follows the person.</p>
</dd>
</dl>
</div>
<div class="section" id="comments-table">
<h3><span class="section-number">4.10.1.2. </span>Comments table<a class="headerlink" href="#comments-table" title="Permalink to this headline">¶</a></h3>
<p>This is the table which stores comments and its metadata.
It stores content of comment, posted date, comment which reply to, and so on.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">_key</span></code></dt><dd><p>Comment ID</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">comment</span></code></dt><dd><p>Content of comment</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">last_modified</span></code></dt><dd><p>Posted date</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">replied_to</span></code></dt><dd><p>Comment which you reply to someone</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">replied_users</span></code></dt><dd><p>List of users who you reply to</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hash_tags</span></code></dt><dd><p>List of hash tags about comment</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">location</span></code></dt><dd><p>Posted place (for geolocation)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">posted_by</span></code></dt><dd><p>Person who write comment</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">favorited_by</span></code></dt><dd><p>Indexes for <code class="docutils literal notranslate"><span class="pre">favorites</span></code> column in <code class="docutils literal notranslate"><span class="pre">Users</span></code> table.
With this indexes, you can search the person who mark comment as favorite one.</p>
</dd>
</dl>
</div>
<div class="section" id="hashtags-table">
<h3><span class="section-number">4.10.1.3. </span>HashTags table<a class="headerlink" href="#hashtags-table" title="Permalink to this headline">¶</a></h3>
<p>This is the table which stores hash tags for comments.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">_key</span></code></dt><dd><p>Hash tag</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">hash_index</span></code></dt><dd><p>Indexes for <code class="docutils literal notranslate"><span class="pre">Comments.hash_tags</span></code>.
With this indexes, you can search list of comments with specified hash tags.</p>
</dd>
</dl>
</div>
<div class="section" id="bigram-table">
<h3><span class="section-number">4.10.1.4. </span>Bigram table<a class="headerlink" href="#bigram-table" title="Permalink to this headline">¶</a></h3>
<p>This is the table which stores indexes for full text search by user information or comments.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">_key</span></code></dt><dd><p>Word</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">users_index</span></code></dt><dd><p>Indexes of user information.
This column contains indexes of user name (<code class="docutils literal notranslate"><span class="pre">Users.name</span></code>), current location (<code class="docutils literal notranslate"><span class="pre">Users.location_str</span></code>), profile (<code class="docutils literal notranslate"><span class="pre">Users.description</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">comment_index</span></code></dt><dd><p>Indexes about content of comments (<code class="docutils literal notranslate"><span class="pre">Comments.comment</span></code>).</p>
</dd>
</dl>
</div>
<div class="section" id="geoindex-table">
<h3><span class="section-number">4.10.1.5. </span>GeoIndex table<a class="headerlink" href="#geoindex-table" title="Permalink to this headline">¶</a></h3>
<p>This is the table which stores indexes of location column to search geo location effectively.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">users_location</span></code></dt><dd><p>Indexes of location column for Users table</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">comments_location</span></code></dt><dd><p>Indexes of location column for Comments table</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="loading-data">
<h2><span class="section-number">4.10.2. </span>Loading data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h2>
<p>Then, load example data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Alice&quot;</span><span class="p">,</span>
    <span class="s2">&quot;follower&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bob&quot;</span><span class="p">],</span>
    <span class="s2">&quot;favorites&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;152489000x-255829000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location_str&quot;</span><span class="p">:</span> <span class="s2">&quot;Boston, Massachusetts&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga developer&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span>
    <span class="s2">&quot;follower&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span><span class="s2">&quot;charlie&quot;</span><span class="p">],</span>
    <span class="s2">&quot;favorites&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice:1&quot;</span><span class="p">,</span><span class="s2">&quot;charlie:1&quot;</span><span class="p">],</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;146249000x-266228000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location_str&quot;</span><span class="p">:</span> <span class="s2">&quot;Brooklyn, New York City&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;charlie&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span>
    <span class="s2">&quot;follower&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span><span class="s2">&quot;bob&quot;</span><span class="p">],</span>
    <span class="s2">&quot;favorites&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice:1&quot;</span><span class="p">,</span><span class="s2">&quot;bob:1&quot;</span><span class="p">],</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;146607190x-267021260&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location_str&quot;</span><span class="p">:</span> <span class="s2">&quot;Newark, New Jersey&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Hmm,Hmm&quot;</span>
  <span class="p">}</span>
<span class="p">]</span>

<span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span>
<span class="p">[</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;alice:1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;ve created micro-blog!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 12:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;bob:1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;First post. test,test...&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 12:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;alice:2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;@bob Welcome!!!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 12:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;replied_to&quot;</span><span class="p">:</span> <span class="s2">&quot;bob:1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;replied_users&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;bob&quot;</span><span class="p">],</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;alice&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;bob:2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;@alice Thanks!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 13:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;replied_to&quot;</span><span class="p">:</span> <span class="s2">&quot;alice:2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;replied_users&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice&quot;</span><span class="p">],</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;bob:3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;ve just used &#39;Try-Groonga&#39; now! #groonga&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 14:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hash_tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;groonga&quot;</span><span class="p">],</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;146566000x-266422000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;bob:4&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m come at city of New York for development camp! #groonga #travel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 14:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;hash_tags&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;groonga&quot;</span><span class="p">,</span> <span class="s2">&quot;travel&quot;</span><span class="p">],</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;146566000x-266422000&quot;</span><span class="p">,</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;bob&quot;</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;charlie:1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;@alice @bob I&#39;ve tried to register!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 15:00:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;replied_users&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;alice&quot;</span><span class="p">,</span> <span class="s2">&quot;bob&quot;</span><span class="p">],</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;146607190x-267021260&quot;</span><span class="p">,</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;charlie&quot;</span><span class="p">,</span>
  <span class="p">}</span>
  <span class="p">{</span>
    <span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;charlie:2&quot;</span><span class="p">,</span>
    <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;I&#39;m at the Museum of Modern Art in NY now!&quot;</span><span class="p">,</span>
    <span class="s2">&quot;last_modified&quot;</span><span class="p">:</span> <span class="s2">&quot;2010/03/17 15:05:00&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;146741340x-266319590&quot;</span><span class="p">,</span>
    <span class="s2">&quot;posted_by&quot;</span><span class="p">:</span> <span class="s2">&quot;charlie&quot;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">follower</span></code> column and <code class="docutils literal notranslate"><span class="pre">favorites</span></code> column in <code class="docutils literal notranslate"><span class="pre">Users</span></code> table and <code class="docutils literal notranslate"><span class="pre">replied_users</span></code> column in <code class="docutils literal notranslate"><span class="pre">Comments</span></code> table are vector column, so specify the value as an array.</p>
<p><code class="docutils literal notranslate"><span class="pre">location</span></code> column in <code class="docutils literal notranslate"><span class="pre">Users</span></code> table, <code class="docutils literal notranslate"><span class="pre">location</span></code> column in <code class="docutils literal notranslate"><span class="pre">Comments</span></code> table use GeoPoint type. This type accepts “[latitude]x[longitude]”.</p>
<p><code class="docutils literal notranslate"><span class="pre">last_modified</span></code> column in <code class="docutils literal notranslate"><span class="pre">Comments</span></code> table use Time type.</p>
<p>There are two way to specify the value.
First, specify epoch (seconds since Jan, 1, 1970 AM 00:00:00) directly. In this case, you can specify micro seconds as fractional part.
The value is converted from factional part to the time which is micro seconds based one when data is loaded.
The second, specify the timestamp as string in following format: “(YEAR)/(MONTH)/(DAY) (HOUR):(MINUTE):(SECOND)”. In this way, the string is casted to proper micro seconds
when data is loaded.</p>
</div>
<div class="section" id="search">
<h2><span class="section-number">4.10.3. </span>Search<a class="headerlink" href="#search" title="Permalink to this headline">¶</a></h2>
<p>Let’s search micro-blog.</p>
<div class="section" id="search-users-by-keyword">
<h3><span class="section-number">4.10.3.1. </span>Search users by keyword<a class="headerlink" href="#search-users-by-keyword" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search micro-blog against multiple column by keyword.
See <a class="reference internal" href="match_columns.html"><span class="doc">match_columns parameter</span></a> to search multiple column at once.</p>
<p>Let’s search user from micro-blog’s user name, location, description entries.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">match_columns</span> <span class="n">name</span><span class="p">,</span><span class="n">location_str</span><span class="p">,</span><span class="n">description</span> <span class="o">--</span><span class="n">query</span> <span class="s2">&quot;New York&quot;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">name</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;bob&quot;,</span>
<span class="c1">#         &quot;Bob&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>By using “New York” as searching keyword for user, “Bob” who lives in “New York” is listed in search result.</p>
</div>
<div class="section" id="search-users-by-geolocation-data-geopoint">
<h3><span class="section-number">4.10.3.2. </span>Search users by geolocation data (GeoPoint)<a class="headerlink" href="#search-users-by-geolocation-data-geopoint" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search users by column data which use type of GeoPoint.
See <a class="reference internal" href="search.html"><span class="doc">Various search conditions</span></a> about GeoPoint column.</p>
<p>Following example searches users who live in within 20km from specified location.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;geo_in_circle(location,&quot;146710080x-266315480&quot;,20000)&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">name</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;charlie&quot;,</span>
<span class="c1">#         &quot;Charlie&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;bob&quot;,</span>
<span class="c1">#         &quot;Bob&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>It shows that “Bob” and “Charlie” lives in within 20 km from station of “Grand Central Terminal”.</p>
</div>
<div class="section" id="search-users-who-follows-specific-user">
<h3><span class="section-number">4.10.3.3. </span>Search users who follows specific user<a class="headerlink" href="#search-users-who-follows-specific-user" title="Permalink to this headline">¶</a></h3>
<p>In this section, we do reverse resolution of reference relationships which is described at <a class="reference internal" href="index.html"><span class="doc">Tag search and reverse resolution of reference relationships</span></a>.</p>
<p>Following examples shows reverse resolution about <code class="docutils literal notranslate"><span class="pre">follower</span></code> column of <code class="docutils literal notranslate"><span class="pre">Users</span></code> table.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">query</span> <span class="n">follower</span><span class="p">:</span><span class="nd">@bob</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">name</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;alice&quot;,</span>
<span class="c1">#         &quot;Alice&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;charlie&quot;,</span>
<span class="c1">#         &quot;Charlie&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>It shows that “Alice” and “Charlie” follows “Bob”.</p>
</div>
<div class="section" id="search-comments-by-using-the-value-of-geopoint-type">
<h3><span class="section-number">4.10.3.4. </span>Search comments by using the value of GeoPoint type<a class="headerlink" href="#search-comments-by-using-the-value-of-geopoint-type" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search comments which are written within specific location.</p>
<p>Then, we also use drill down which is described at <a class="reference internal" href="drilldown.html"><span class="doc">Drilldown</span></a>.
Following example shows how to drill down against search results.
As a result, we get the value of count which is grouped by user, and hash tags respectively.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;geo_in_circle(location,&quot;146867000x-266280000&quot;,20000)&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">posted_by</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">comment</span> <span class="o">--</span><span class="n">drilldown</span> <span class="n">hash_tags</span><span class="p">,</span><span class="n">posted_by</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         4</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;posted_by.name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Charlie&quot;,</span>
<span class="c1">#         &quot;I&#39;m at the Museum of Modern Art in NY now!&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;I&#39;ve just used &#39;Try-Groonga&#39; now! #groonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;I&#39;m come at city of New York for development camp! #groonga #travel&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Charlie&quot;,</span>
<span class="c1">#         &quot;@alice @bob I&#39;ve tried to register!&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;groonga&quot;,</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;travel&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;charlie&quot;,</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;bob&quot;,</span>
<span class="c1">#         2</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>Above query searches comments which are posted within 20 km from Central Park in city of New York.</p>
<p>As specified range is 20 km, all comments with location are collected.
You know that search results contain 2 #groonga hash tags and one #travel hash tag, and bob and charlie posted 2 comments.</p>
</div>
<div class="section" id="search-comments-by-keyword">
<h3><span class="section-number">4.10.3.5. </span>Search comments by keyword<a class="headerlink" href="#search-comments-by-keyword" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search comments which contains specific keyword.
And more, Let’s calculate the value of <cite>_score</cite> which is described at <a class="reference internal" href="search.html"><span class="doc">Various search conditions</span></a>.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">query</span> <span class="n">comment</span><span class="p">:</span><span class="nd">@Now</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">comment</span><span class="p">,</span><span class="n">_score</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_score&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;I&#39;ve just used &#39;Try-Groonga&#39; now! #groonga&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;I&#39;m at the Museum of Modern Art in NY now!&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>By using ‘Now’ as a keyword, above query returns 2 comments. It also contains count of ‘Now’ as the value of <cite>_score</cite>.</p>
</div>
<div class="section" id="search-comments-by-keyword-and-geolocation">
<h3><span class="section-number">4.10.3.6. </span>Search comments by keyword and geolocation<a class="headerlink" href="#search-comments-by-keyword-and-geolocation" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search comments by specific keyword and geolocation.
By using <cite>–query</cite> and <cite>–filter</cite> option, following query returns records which are matched to both conditions.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">query</span> <span class="n">comment</span><span class="p">:</span><span class="nd">@New</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;geo_in_circle(location,&quot;146867000x-266280000&quot;,20000)&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">posted_by</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">comment</span> <span class="o">--</span><span class="n">drilldown</span> <span class="n">hash_tags</span><span class="p">,</span><span class="n">posted_by</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;posted_by.name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;I&#39;m come at city of New York for development camp! #groonga #travel&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;groonga&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;travel&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;bob&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>It returns 1 comment which meets both condition.
It also returns result of drilldown. There is 1 comment which is commented by Bob.</p>
</div>
<div class="section" id="search-comments-by-hash-tags">
<h3><span class="section-number">4.10.3.7. </span>Search comments by hash tags<a class="headerlink" href="#search-comments-by-hash-tags" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search comments which contains specific hash tags.
Let’s use reverse resolution of reference relationships.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">query</span> <span class="n">hash_tags</span><span class="p">:</span><span class="nd">@groonga</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">posted_by</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">comment</span> <span class="o">--</span><span class="n">drilldown</span> <span class="n">posted_by</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;posted_by.name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;I&#39;ve just used &#39;Try-Groonga&#39; now! #groonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;I&#39;m come at city of New York for development camp! #groonga #travel&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;bob&quot;,</span>
<span class="c1">#         2</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>Above query returns 2 comments which contains #groonga hash tag.
It also returns result of drilldown grouped by person who posted it. It shows that there are 2 comments. Bob commented it.</p>
</div>
<div class="section" id="search-comments-by-user-id">
<h3><span class="section-number">4.10.3.8. </span>Search comments by user id<a class="headerlink" href="#search-comments-by-user-id" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search comments which are posted by specific user.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Comments</span> <span class="o">--</span><span class="n">query</span> <span class="n">posted_by</span><span class="p">:</span><span class="n">bob</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">comment</span> <span class="o">--</span><span class="n">drilldown</span> <span class="n">hash_tags</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         4</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;First post. test,test...&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;@alice Thanks!&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;I&#39;ve just used &#39;Try-Groonga&#39; now! #groonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;I&#39;m come at city of New York for development camp! #groonga #travel&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;groonga&quot;,</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;travel&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>Above query returns 4 comments which are posted by Bob.
It also returns result of drilldown by hash tags. There are 2 comments which contains #groonga, and 1 comment which contains #travel as hash tag.</p>
</div>
<div class="section" id="search-user-s-favorite-comments">
<h3><span class="section-number">4.10.3.9. </span>Search user’s favorite comments<a class="headerlink" href="#search-user-s-favorite-comments" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search user’s favorite comments.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">--</span><span class="n">table</span> <span class="n">Users</span> <span class="o">--</span><span class="n">query</span> <span class="n">_key</span><span class="p">:</span><span class="n">bob</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">favorites</span><span class="o">.</span><span class="n">posted_by</span><span class="p">,</span><span class="n">favorites</span><span class="o">.</span><span class="n">comment</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;favorites.posted_by&quot;,</span>
<span class="c1">#           &quot;Users&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;favorites.comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;alice&quot;,</span>
<span class="c1">#           &quot;charlie&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;I&#39;ve created micro-blog!&quot;,</span>
<span class="c1">#           &quot;@alice @bob I&#39;ve tried to register!&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>Above query returns Bob’s favorite comments.</p>
</div>
<div class="section" id="search-comments-by-posted-time">
<h3><span class="section-number">4.10.3.10. </span>Search comments by posted time<a class="headerlink" href="#search-comments-by-posted-time" title="Permalink to this headline">¶</a></h3>
<p>In this section, we search comments by posted time.
See type of <cite>Time</cite> in <a class="reference internal" href="data.html"><span class="doc">Various data types</span></a>.</p>
<p>Let’s search comments that posted time are older than specified time.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Comments</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;last_modified&lt;=1268802000&#39;</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">posted_by</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="n">comment</span><span class="p">,</span><span class="n">last_modified</span> <span class="o">--</span><span class="n">drilldown</span> <span class="n">hash_tags</span><span class="p">,</span><span class="n">posted_by</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         5</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;posted_by.name&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;comment&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;last_modified&quot;,</span>
<span class="c1">#           &quot;Time&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Alice&quot;,</span>
<span class="c1">#         &quot;I&#39;ve created micro-blog!&quot;,</span>
<span class="c1">#         1268795100.0</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;First post. test,test...&quot;,</span>
<span class="c1">#         1268794800.0</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Alice&quot;,</span>
<span class="c1">#         &quot;@bob Welcome!!!&quot;,</span>
<span class="c1">#         1268795100.0</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;@alice Thanks!&quot;,</span>
<span class="c1">#         1268798400.0</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Bob&quot;,</span>
<span class="c1">#         &quot;I&#39;ve just used &#39;Try-Groonga&#39; now! #groonga&quot;,</span>
<span class="c1">#         1268802000.0</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         1</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;groonga&quot;,</span>
<span class="c1">#         1</span>
<span class="c1">#       ]</span>
<span class="c1">#     ],</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_nsubrecs&quot;,</span>
<span class="c1">#           &quot;Int32&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;alice&quot;,</span>
<span class="c1">#         2</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;bob&quot;,</span>
<span class="c1">#         3</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>Above query returns 5 comments which are older than 2010/03/17 14:00:00.
It also returns result of drilldown by posted person. There are 2 comments by Alice, 3 comments by Bob.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.10. Let’s create micro-blog</a><ul>
<li><a class="reference internal" href="#create-a-table">4.10.1. Create a table</a><ul>
<li><a class="reference internal" href="#users-table">4.10.1.1. Users table</a></li>
<li><a class="reference internal" href="#comments-table">4.10.1.2. Comments table</a></li>
<li><a class="reference internal" href="#hashtags-table">4.10.1.3. HashTags table</a></li>
<li><a class="reference internal" href="#bigram-table">4.10.1.4. Bigram table</a></li>
<li><a class="reference internal" href="#geoindex-table">4.10.1.5. GeoIndex table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loading-data">4.10.2. Loading data</a></li>
<li><a class="reference internal" href="#search">4.10.3. Search</a><ul>
<li><a class="reference internal" href="#search-users-by-keyword">4.10.3.1. Search users by keyword</a></li>
<li><a class="reference internal" href="#search-users-by-geolocation-data-geopoint">4.10.3.2. Search users by geolocation data (GeoPoint)</a></li>
<li><a class="reference internal" href="#search-users-who-follows-specific-user">4.10.3.3. Search users who follows specific user</a></li>
<li><a class="reference internal" href="#search-comments-by-using-the-value-of-geopoint-type">4.10.3.4. Search comments by using the value of GeoPoint type</a></li>
<li><a class="reference internal" href="#search-comments-by-keyword">4.10.3.5. Search comments by keyword</a></li>
<li><a class="reference internal" href="#search-comments-by-keyword-and-geolocation">4.10.3.6. Search comments by keyword and geolocation</a></li>
<li><a class="reference internal" href="#search-comments-by-hash-tags">4.10.3.7. Search comments by hash tags</a></li>
<li><a class="reference internal" href="#search-comments-by-user-id">4.10.3.8. Search comments by user id</a></li>
<li><a class="reference internal" href="#search-user-s-favorite-comments">4.10.3.9. Search user’s favorite comments</a></li>
<li><a class="reference internal" href="#search-comments-by-posted-time">4.10.3.10. Search comments by posted time</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lexicon.html"
                        title="previous chapter"><span class="section-number">4.9. </span>Additional information about lexicon for full text search</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="query_expansion.html"
                        title="next chapter"><span class="section-number">4.11. </span>Query expansion</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="query_expansion.html" title="4.11. Query expansion"
             >next</a> |</li>
        <li class="right" >
          <a href="lexicon.html" title="4.9. Additional information about lexicon for full text search"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Groonga v11.0.7 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../tutorial.html" ><span class="section-number">4. </span>Tutorial</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">4.10. </span>Let’s create micro-blog</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2021, Brazil, Inc.
    </div>
      <script src="http://connect.facebook.net/en_US/all.js"></script>

    <script>
      FB.init({
         appId  : null,
         status : true, // check login status
         cookie : true, // enable cookies to allow the server to access the session
         xfbml  : true  // parse XFBML
      });
    </script>
  </body>

</html>