<!DOCTYPE html>

<html lang="en">
  <head>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-7532323-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-7532323-1');
    </script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>7.15.12. in_values &#8212; Groonga v11.0.4 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../static/groonga.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../static/documentation_options.js"></script>
    <script src="../../static/jquery.js"></script>
    <script src="../../static/underscore.js"></script>
    <script src="../../static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="7.15.13. math_abs" href="math_abs.html" />
    <link rel="prev" title="7.15.11. in_records" href="in_records.html" /> 
      <meta property="fb:page_id" content="201193596592346" /><!-- groonga -->
    <meta property="fb:admins" content="664204556" /><!-- kouhei.sutou -->
    <meta property="og:type" content="product" />
    <meta property="og:image" content="http://groonga.org/images/logos/groonga-icon-full-size.png" />
    <meta property="og:site_name" content="groonga" />

    <link rel="stylesheet" href="/css/sphinx.css" type="text/css" />
  </head>
  <body>
    <div id="fb-root"></div>

<div class="header">
  <h1 class="title">
    <a id="top-link" href="../../../">
      <span class="project">groonga</span>
      <span class="separator">-</span>
      <span class="description">An open-source fulltext search engine and column store.</span>
    </a>
  </h1>

      <div class="facebook-buttons">
      <fb:like href="http://www.facebook.com/pages/groonga/201193596592346"
               layout="standard"
               width="290"></fb:like>
    </div>
    <div class="other-language-links">

    <ul>
      <li><a href="../../../ja/docs/reference/functions/in_values.html">日本語</a></li>
    </ul>
  </div>
</div>
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="math_abs.html" title="7.15.13. math_abs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="in_records.html" title="7.15.11. in_records"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Groonga v11.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference.html" ><span class="section-number">7. </span>Reference manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../function.html" accesskey="U"><span class="section-number">7.15. </span>Function</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">7.15.12. </span><code class="docutils literal notranslate"><span class="pre">in_values</span></code></a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="in-values">
<h1><span class="section-number">7.15.12. </span><code class="docutils literal notranslate"><span class="pre">in_values</span></code><a class="headerlink" href="#in-values" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2><span class="section-number">7.15.12.1. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.0.7.</span></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">in_values</span></code> enables you to simplify the query which uses multiple <code class="docutils literal notranslate"><span class="pre">OR</span></code> or <code class="docutils literal notranslate"><span class="pre">==</span></code>. It is recommended to use this function in point of view about performance improvements in such a case.</p>
</div>
<div class="section" id="syntax">
<h2><span class="section-number">7.15.12.2. </span>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">in_values</span></code> requires two or more arguments - <code class="docutils literal notranslate"><span class="pre">target_value</span></code>, multiple <code class="docutils literal notranslate"><span class="pre">value</span></code>, and options.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">in_values</span><span class="p">(</span><span class="n">target_value</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">valueN</span><span class="p">)</span>
<span class="n">in_values</span><span class="p">(</span><span class="n">target_value</span><span class="p">,</span> <span class="n">value1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">valueN</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;option&quot;</span><span class="p">:</span> <span class="s2">&quot;value of option&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h2><span class="section-number">7.15.12.3. </span>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Here is a schema definition and sample data.</p>
<p>Sample schema:</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table_create</span> <span class="n">Tags</span> <span class="n">TABLE_PAT_KEY</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">table_create</span> <span class="n">Memos</span> <span class="n">TABLE_HASH_KEY</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Memos</span> <span class="n">tag</span> <span class="n">COLUMN_SCALAR</span> <span class="n">ShortText</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
<span class="n">column_create</span> <span class="n">Tags</span> <span class="n">memos_tag</span> <span class="n">COLUMN_INDEX</span> <span class="n">Memos</span> <span class="n">tag</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], true]</span>
</pre></div>
</div>
<p>Sample data:</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">load</span> <span class="o">--</span><span class="n">table</span> <span class="n">Memos</span>
<span class="p">[</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is fast&quot;</span><span class="p">,</span>          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;groonga&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Mroonga is fast&quot;</span><span class="p">,</span>          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;mroonga&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Rroonga is fast&quot;</span><span class="p">,</span>          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;rroonga&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Droonga is fast&quot;</span><span class="p">,</span>          <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;droonga&quot;</span><span class="p">},</span>
<span class="p">{</span><span class="s2">&quot;_key&quot;</span><span class="p">:</span> <span class="s2">&quot;Groonga is a HTTP server&quot;</span><span class="p">,</span> <span class="s2">&quot;tag&quot;</span><span class="p">:</span> <span class="s2">&quot;groonga&quot;</span><span class="p">}</span>
<span class="p">]</span>
<span class="c1"># [[0, 1337566253.89858, 0.000355720520019531], 5]</span>
</pre></div>
</div>
<p>Here is the simple usage of <code class="docutils literal notranslate"><span class="pre">in_values</span></code> function which selects the records - the value of <code class="docutils literal notranslate"><span class="pre">tag</span></code> column is “groonga” or “mroonga” or “droonga”.</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Memos</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">tag</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;in_values(tag, &quot;groonga&quot;, &quot;mroonga&quot;, &quot;droonga&quot;)&#39;</span> <span class="o">--</span><span class="n">sort_keys</span> <span class="n">_id</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         4</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;tag&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Groonga is fast&quot;,</span>
<span class="c1">#         &quot;groonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Mroonga is fast&quot;,</span>
<span class="c1">#         &quot;mroonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Droonga is fast&quot;,</span>
<span class="c1">#         &quot;droonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Groonga is a HTTP server&quot;,</span>
<span class="c1">#         &quot;groonga&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
<p>When executing the above query, you can get the records except “rroonga” because “rroonga” is not specified as value in <code class="docutils literal notranslate"><span class="pre">in_values</span></code>.</p>
<p>Then, you can also specify options of <code class="docutils literal notranslate"><span class="pre">in_values</span></code>.
Currently, you can only specify <code class="docutils literal notranslate"><span class="pre">too_many_index_match_ratio</span></code>. The type of this value is <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
<p>You can change the value of <code class="docutils literal notranslate"><span class="pre">GRN_IN_VALUES_TOO_MANY_INDEX_MATCH_RATIO</span></code> with <code class="docutils literal notranslate"><span class="pre">too_many_index_match_ratio</span></code>.
The default value of <code class="docutils literal notranslate"><span class="pre">GRN_IN_VALUES_TOO_MANY_INDEX_MATCH_RATIO</span></code> is <code class="docutils literal notranslate"><span class="pre">0.01</span></code>.
<code class="docutils literal notranslate"><span class="pre">GRN_IN_VALUES_TOO_MANY_INDEX_MATCH_RATIO</span></code> is used for deciding whether <code class="docutils literal notranslate"><span class="pre">in_values</span></code> use an index or not.</p>
<p>There is a case that sequential search is faster than index search when the number of narrowed down records is small enough in contrast to the number of expected records to narrow down by <code class="docutils literal notranslate"><span class="pre">in_values</span></code> with AND operation which use indexes.</p>
<p>For example, suppose you narrow down records by <code class="docutils literal notranslate"><span class="pre">--filter</span></code> and you narrow down them by <code class="docutils literal notranslate"><span class="pre">in_values</span></code>.</p>
<p>In the default, <code class="docutils literal notranslate"><span class="pre">in_values</span></code> use sequential search in the following case.</p>
<blockquote>
<div><ol class="arabic">
<li><p>If you narrow down records to 1,000 by <code class="docutils literal notranslate"><span class="pre">--filter</span></code> and records of the target of <code class="docutils literal notranslate"><span class="pre">in_values</span></code> are 500,000.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="o">/</span><span class="mi">500</span><span class="p">,</span><span class="mi">000</span> <span class="o">=</span> <span class="mf">0.002</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">(</span><span class="n">GRN_IN_VALUES_TOO_MANY_INDEX_MATCH_RATIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">in_values</span> <span class="n">use</span> <span class="n">sequential</span> <span class="n">search</span><span class="o">.</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
<p>On the other hand, <code class="docutils literal notranslate"><span class="pre">in_values</span></code> use index in the following case.</p>
<blockquote>
<div><ol class="arabic" start="2">
<li><p>If you narrow down records to 1,000 by <code class="docutils literal notranslate"><span class="pre">--filter</span></code> and records of the target of <code class="docutils literal notranslate"><span class="pre">in_values</span></code> are 50,000.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">,</span><span class="mi">000</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span><span class="mi">000</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">(</span><span class="n">GRN_IN_VALUES_TOO_MANY_INDEX_MATCH_RATIO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">in_values</span> <span class="n">use</span> <span class="n">index</span><span class="o">.</span>
</pre></div>
</div>
</li>
</ol>
</div></blockquote>
<p>Here is a query to set options of <code class="docutils literal notranslate"><span class="pre">in_values</span></code>:</p>
<p>Execution example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">Memos</span> <span class="o">--</span><span class="n">output_columns</span> <span class="n">_key</span><span class="p">,</span><span class="n">tag</span> <span class="o">--</span><span class="nb">filter</span> <span class="s1">&#39;in_values(tag, &quot;groonga&quot;, &quot;mroonga&quot;, &quot;droonga&quot;, {&quot;too_many_index_match_ratio&quot;:0.001})&#39;</span> <span class="o">--</span><span class="n">sort_keys</span> <span class="n">_id</span>
<span class="c1"># [</span>
<span class="c1">#   [</span>
<span class="c1">#     0,</span>
<span class="c1">#     1337566253.89858,</span>
<span class="c1">#     0.000355720520019531</span>
<span class="c1">#   ],</span>
<span class="c1">#   [</span>
<span class="c1">#     [</span>
<span class="c1">#       [</span>
<span class="c1">#         4</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;_key&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ],</span>
<span class="c1">#         [</span>
<span class="c1">#           &quot;tag&quot;,</span>
<span class="c1">#           &quot;ShortText&quot;</span>
<span class="c1">#         ]</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Groonga is fast&quot;,</span>
<span class="c1">#         &quot;groonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Mroonga is fast&quot;,</span>
<span class="c1">#         &quot;mroonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Droonga is fast&quot;,</span>
<span class="c1">#         &quot;droonga&quot;</span>
<span class="c1">#       ],</span>
<span class="c1">#       [</span>
<span class="c1">#         &quot;Groonga is a HTTP server&quot;,</span>
<span class="c1">#         &quot;groonga&quot;</span>
<span class="c1">#       ]</span>
<span class="c1">#     ]</span>
<span class="c1">#   ]</span>
<span class="c1"># ]</span>
</pre></div>
</div>
</div>
<div class="section" id="parameters">
<h2><span class="section-number">7.15.12.4. </span>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>There are two or more required parameter, <code class="docutils literal notranslate"><span class="pre">target_value</span></code> and multiple <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<div class="section" id="target-value">
<h3><span class="section-number">7.15.12.4.1. </span><code class="docutils literal notranslate"><span class="pre">target_value</span></code><a class="headerlink" href="#target-value" title="Permalink to this headline">¶</a></h3>
<p>Specifies a column of the table that is specified by <code class="docutils literal notranslate"><span class="pre">table</span></code> parameter in <code class="docutils literal notranslate"><span class="pre">select</span></code>.</p>
</div>
<div class="section" id="value">
<h3><span class="section-number">7.15.12.4.2. </span><code class="docutils literal notranslate"><span class="pre">value</span></code><a class="headerlink" href="#value" title="Permalink to this headline">¶</a></h3>
<p>Specifies a value of the column which you want to select.</p>
</div>
<div class="section" id="option-value-of-option">
<h3><span class="section-number">7.15.12.4.3. </span><code class="docutils literal notranslate"><span class="pre">{&quot;option&quot;:</span> <span class="pre">&quot;value</span> <span class="pre">of</span> <span class="pre">option&quot;}</span></code><a class="headerlink" href="#option-value-of-option" title="Permalink to this headline">¶</a></h3>
<p>Specify in_values’s option.
Currently, you can only specify <code class="docutils literal notranslate"><span class="pre">too_many_index_match_ratio</span></code>. The type of this value is <code class="docutils literal notranslate"><span class="pre">double</span></code>.</p>
</div>
</div>
<div class="section" id="return-value">
<h2><span class="section-number">7.15.12.5. </span>Return value<a class="headerlink" href="#return-value" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">in_values</span></code> returns whether the value of column exists in specified the value of parameters or not.</p>
<p>If record is matched to specified the value of parameters, it returns true. Otherwise, it returns false.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">7.15.12. <code class="docutils literal notranslate"><span class="pre">in_values</span></code></a><ul>
<li><a class="reference internal" href="#summary">7.15.12.1. Summary</a></li>
<li><a class="reference internal" href="#syntax">7.15.12.2. Syntax</a></li>
<li><a class="reference internal" href="#usage">7.15.12.3. Usage</a></li>
<li><a class="reference internal" href="#parameters">7.15.12.4. Parameters</a><ul>
<li><a class="reference internal" href="#target-value">7.15.12.4.1. <code class="docutils literal notranslate"><span class="pre">target_value</span></code></a></li>
<li><a class="reference internal" href="#value">7.15.12.4.2. <code class="docutils literal notranslate"><span class="pre">value</span></code></a></li>
<li><a class="reference internal" href="#option-value-of-option">7.15.12.4.3. <code class="docutils literal notranslate"><span class="pre">{&quot;option&quot;:</span> <span class="pre">&quot;value</span> <span class="pre">of</span> <span class="pre">option&quot;}</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#return-value">7.15.12.5. Return value</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="in_records.html"
                        title="previous chapter"><span class="section-number">7.15.11. </span><code class="docutils literal notranslate"><span class="pre">in_records</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="math_abs.html"
                        title="next chapter"><span class="section-number">7.15.13. </span><code class="docutils literal notranslate"><span class="pre">math_abs</span></code></a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="math_abs.html" title="7.15.13. math_abs"
             >next</a> |</li>
        <li class="right" >
          <a href="in_records.html" title="7.15.11. in_records"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Groonga v11.0.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../reference.html" ><span class="section-number">7. </span>Reference manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../function.html" ><span class="section-number">7.15. </span>Function</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">7.15.12. </span><code class="docutils literal notranslate"><span class="pre">in_values</span></code></a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2021, Brazil, Inc.
    </div>
      <script src="http://connect.facebook.net/en_US/all.js"></script>

    <script>
      FB.init({
         appId  : null,
         status : true, // check login status
         cookie : true, // enable cookies to allow the server to access the session
         xfbml  : true  // parse XFBML
      });
    </script>
  </body>

</html>