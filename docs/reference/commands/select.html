<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.3.29. select &mdash; Groonga v4.10 documentation</title>
    
    <link rel="stylesheet" href="../../static/groonga.css" type="text/css" />
    <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '4.10',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../static/jquery.js"></script>
    <script type="text/javascript" src="../../static/underscore.js"></script>
    <script type="text/javascript" src="../../static/doctools.js"></script>
    <link rel="shortcut icon" href="../../static/favicon.ico"/>
    <link rel="top" title="Groonga v4.10 documentation" href="../../index.html" />
    <link rel="up" title="7.3. Command" href="../command.html" />
    <link rel="next" title="7.3.30. shutdown" href="shutdown.html" />
    <link rel="prev" title="7.3.28. ruby_load" href="ruby_load.html" /> 
      <meta property="fb:page_id" content="201193596592346" /><!-- groonga -->
    <meta property="fb:admins" content="664204556" /><!-- kouhei.sutou -->
    <meta property="og:type" content="product" />
    <meta property="og:image" content="http://groonga.org/images/logos/groonga-icon-full-size.png" />
    <meta property="og:site_name" content="groonga" />

    <link rel="stylesheet" href="/css/sphinx.css" type="text/css" />
  </head>

    <body>
    <div id="fb-root"></div>

<div class="header">
  <h1 class="title">
    <a id="top-link" href="../../../">
      <span class="project">groonga</span>
      <span class="separator">-</span>
      <span class="description">An open-source fulltext search engine and column store.</span>
    </a>
  </h1>

      <div class="facebook-buttons">
      <fb:like href="http://www.facebook.com/pages/groonga/201193596592346"
               layout="standard"
               width="290"></fb:like>
    </div>
    <div class="other-language-links">

    <ul>
      <li><a href="../../../ja/docs/reference/commands/select.html"><img src="../../static/jp.png" alt="日本語">日本語版はこちら</a></li>
    </ul>
  </div>
</div>
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="shutdown.html" title="7.3.30. shutdown"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ruby_load.html" title="7.3.28. ruby_load"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Groonga v4.10 documentation</a> &raquo;</li>
          <li><a href="../../reference.html" >7. Reference manual</a> &raquo;</li>
          <li><a href="../command.html" accesskey="U">7.3. Command</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="select">
<h1>7.3.29. <tt class="docutils literal"><span class="pre">select</span></tt><a class="headerlink" href="#select" title="Permalink to this headline">¶</a></h1>
<div class="section" id="summary">
<h2>7.3.29.1. Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">select</span></tt> searches records that are matched to specified conditions
from a table and then outputs them.</p>
<p><tt class="docutils literal"><span class="pre">select</span></tt> is the most important command in groonga. You need to
understand <tt class="docutils literal"><span class="pre">select</span></tt> to use the full power of groonga.</p>
</div>
<div class="section" id="syntax">
<h2>7.3.29.2. Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">select</span></tt> has many parameters. The required parameter is only
<tt class="docutils literal"><span class="pre">table</span></tt> and others are optional:</p>
<div class="highlight-none"><div class="highlight"><pre>select table
       [match_columns=null]
       [query=null]
       [filter=null]
       [scorer=null]
       [sortby=null]
       [output_columns=&quot;_id, _key, *&quot;]
       [offset=0]
       [limit=10]
       [drilldown=null]
       [drilldown_sortby=null]
       [drilldown_output_columns=&quot;_key, _nsubrecs&quot;]
       [drilldown_offset=0]
       [drilldown_limit=10]
       [cache=yes]
       [match_escalation_threshold=0]
       [query_expansion=null]
       [query_flags=ALLOW_PRAGMA|ALLOW_COLUMN|ALLOW_UPDATE|ALLOW_LEADING_NOT|NONE]
       [query_expander=null]
       [adjuster=null]
       [drilldown_calc_types=NONE]
       [drilldown_calc_target=null]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">select</span></tt> has the following named parameters for advanced drilldown:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys=null</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].sortby=null</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns=&quot;_key,</span> <span class="pre">_nsubrecs&quot;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].offset=0</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].limit=10</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].calc_types=NONE</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].calc_target=null</span></tt></li>
</ul>
</div></blockquote>
<p>You can use one or more alphabets, digits, <tt class="docutils literal"><span class="pre">_</span></tt> and <tt class="docutils literal"><span class="pre">.</span></tt> for
<tt class="docutils literal"><span class="pre">${LABEL}</span></tt>. For example, <tt class="docutils literal"><span class="pre">parent.sub1</span></tt> is a valid <tt class="docutils literal"><span class="pre">${LABEL}</span></tt>.</p>
<p>Parameters that have the same <tt class="docutils literal"><span class="pre">${LABEL}</span></tt> are grouped.</p>
<p>For example, the following parameters specify one drilldown:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">--drilldown[label].keys</span> <span class="pre">column</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label].sortby</span> <span class="pre">-_nsubrecs</span></tt></li>
</ul>
</div></blockquote>
<p>The following parameters specify two drilldowns:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">--drilldown[label1].keys</span> <span class="pre">column1</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label1].sortby</span> <span class="pre">-_nsubrecs</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label2].keys</span> <span class="pre">column2</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label2].sortby</span> <span class="pre">_key</span></tt></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="usage">
<h2>7.3.29.3. Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Let's learn about <tt class="docutils literal"><span class="pre">select</span></tt> usage with examples. This section shows
many popular usages.</p>
<p>Here are a schema definition and sample data to show usage.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>table_create Entries TABLE_HASH_KEY ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Entries content COLUMN_SCALAR Text
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Entries n_likes COLUMN_SCALAR UInt32
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Entries tag COLUMN_SCALAR ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
table_create Terms TABLE_PAT_KEY|KEY_NORMALIZE ShortText --default_tokenizer TokenBigram
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Terms entries_key_index COLUMN_INDEX|WITH_POSITION Entries _key
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Terms entries_content_index COLUMN_INDEX|WITH_POSITION Entries content
# [[0, 1337566253.89858, 0.000355720520019531], true]
load --table Entries
[
{&quot;_key&quot;:    &quot;The first post!&quot;,
 &quot;content&quot;: &quot;Welcome! This is my first post!&quot;,
 &quot;n_likes&quot;: 5,
 &quot;tag&quot;: &quot;Hello&quot;},
{&quot;_key&quot;:    &quot;Groonga&quot;,
 &quot;content&quot;: &quot;I started to use Groonga. It&#39;s very fast!&quot;,
 &quot;n_likes&quot;: 10,
 &quot;tag&quot;: &quot;Groonga&quot;},
{&quot;_key&quot;:    &quot;Mroonga&quot;,
 &quot;content&quot;: &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
 &quot;n_likes&quot;: 15,
 &quot;tag&quot;: &quot;Groonga&quot;},
{&quot;_key&quot;:    &quot;Good-bye Senna&quot;,
 &quot;content&quot;: &quot;I migrated all Senna system!&quot;,
 &quot;n_likes&quot;: 3,
 &quot;tag&quot;: &quot;Senna&quot;},
{&quot;_key&quot;:    &quot;Good-bye Tritonn&quot;,
 &quot;content&quot;: &quot;I also migrated all Tritonn system!&quot;,
 &quot;n_likes&quot;: 3,
 &quot;tag&quot;: &quot;Senna&quot;}
]
# [[0, 1337566253.89858, 0.000355720520019531], 5]
</pre></div>
</div>
<p>There is a table, <tt class="docutils literal"><span class="pre">Entries</span></tt>, for blog entries. An entry has title,
content, the number of likes for the entry and tag. Title is key of
<tt class="docutils literal"><span class="pre">Entries</span></tt>. Content is value of <tt class="docutils literal"><span class="pre">Entries.content</span></tt> column. The
number of likes is value of <tt class="docutils literal"><span class="pre">Entries.n_likes</span></tt> column. Tag is value
of <tt class="docutils literal"><span class="pre">Entries.tag</span></tt> column.</p>
<p><tt class="docutils literal"><span class="pre">Entries._key</span></tt> column and <tt class="docutils literal"><span class="pre">Entries.content</span></tt> column are indexed
using <tt class="docutils literal"><span class="pre">TokenBigram</span></tt> tokenizer. So both <tt class="docutils literal"><span class="pre">Entries._key</span></tt> and
<tt class="docutils literal"><span class="pre">Entries.content</span></tt> are fulltext search ready.</p>
<p>OK. The schema and data for examples are ready.</p>
<div class="section" id="simple-usage">
<h3>7.3.29.3.1. Simple usage<a class="headerlink" href="#simple-usage" title="Permalink to this headline">¶</a></h3>
<p>Here is the most simple usage with the above schema and data. It outputs
all records in <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>Why does the command output all records? There are two reasons. The
first reason is that the command doesn't specify any search
conditions. No search condition means all records are matched. The
second reason is that the number of all records is 5. <tt class="docutils literal"><span class="pre">select</span></tt>
command outputs 10 records at a maximum by default. There are only 5
records. It is less than 10. So the command outputs all records.</p>
</div>
<div class="section" id="search-conditions">
<h3>7.3.29.3.2. Search conditions<a class="headerlink" href="#search-conditions" title="Permalink to this headline">¶</a></h3>
<p>Search conditions are specified by <tt class="docutils literal"><span class="pre">query</span></tt> or <tt class="docutils literal"><span class="pre">filter</span></tt>. You can
also specify both <tt class="docutils literal"><span class="pre">query</span></tt> and <tt class="docutils literal"><span class="pre">filter</span></tt>. It means that selected
records must be matched against both <tt class="docutils literal"><span class="pre">query</span></tt> and <tt class="docutils literal"><span class="pre">filter</span></tt>.</p>
<div class="section" id="search-condition-query">
<h4>7.3.29.3.2.1. Search condition: <tt class="docutils literal"><span class="pre">query</span></tt><a class="headerlink" href="#search-condition-query" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">query</span></tt> is designed for search box in Web page. Imagine a search box
in google.com. You specify search conditions for <tt class="docutils literal"><span class="pre">query</span></tt> as space
separated keywords. For example, <tt class="docutils literal"><span class="pre">search</span> <span class="pre">engine</span></tt> means a matched
record should contain two words, <tt class="docutils literal"><span class="pre">search</span></tt> and <tt class="docutils literal"><span class="pre">engine</span></tt>.</p>
<p>Normally, <tt class="docutils literal"><span class="pre">query</span></tt> parameter is used for specifying fulltext search
conditions. It can be used for non fulltext search conditions but
<tt class="docutils literal"><span class="pre">filter</span></tt> is used for the propose.</p>
<p><tt class="docutils literal"><span class="pre">query</span></tt> parameter is used with <tt class="docutils literal"><span class="pre">match_columns</span></tt> parameter when
<tt class="docutils literal"><span class="pre">query</span></tt> parameter is used for specifying fulltext search
conditions. <tt class="docutils literal"><span class="pre">match_columns</span></tt> specifies which columnes and indexes are
matched against <tt class="docutils literal"><span class="pre">query</span></tt>.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">query</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query fast
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain a word <tt class="docutils literal"><span class="pre">fast</span></tt>
in <tt class="docutils literal"><span class="pre">content</span></tt> column value from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p><tt class="docutils literal"><span class="pre">query</span></tt> has query syntax but its deatils aren't described here. See
<a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a> for datails.</p>
</div>
<div class="section" id="search-condition-filter">
<h4>7.3.29.3.2.2. Search condition: <tt class="docutils literal"><span class="pre">filter</span></tt><a class="headerlink" href="#search-condition-filter" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">filter</span></tt> is designed for complex search conditions. You specify
search conditions for <tt class="docutils literal"><span class="pre">filter</span></tt> as ECMAScript like syntax.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">filter</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --filter &#39;content @ &quot;fast&quot; &amp;&amp; _key == &quot;Groonga&quot;&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain a word <tt class="docutils literal"><span class="pre">fast</span></tt>
in <tt class="docutils literal"><span class="pre">content</span></tt> column value and has <tt class="docutils literal"><span class="pre">Groonga</span></tt> as <tt class="docutils literal"><span class="pre">_key</span></tt> from
<tt class="docutils literal"><span class="pre">Entries</span></tt> table. There are three operators in the command, <tt class="docutils literal"><span class="pre">&#64;</span></tt>,
<tt class="docutils literal"><span class="pre">&amp;&amp;</span></tt> and <tt class="docutils literal"><span class="pre">==</span></tt>. <tt class="docutils literal"><span class="pre">&#64;</span></tt> is fulltext search operator. <tt class="docutils literal"><span class="pre">&amp;&amp;</span></tt> and
<tt class="docutils literal"><span class="pre">==</span></tt> are the same as ECMAScript. <tt class="docutils literal"><span class="pre">&amp;&amp;</span></tt> is logical AND operator and
<tt class="docutils literal"><span class="pre">==</span></tt> is equality operator.</p>
<p><tt class="docutils literal"><span class="pre">filter</span></tt> has more operators and syntax like grouping by <tt class="docutils literal"><span class="pre">(...)</span></tt>
its details aren't described here. See
<a class="reference internal" href="../grn_expr/script_syntax.html"><em>Script syntax</em></a> for datails.</p>
</div>
</div>
<div class="section" id="paging">
<h3>7.3.29.3.3. Paging<a class="headerlink" href="#paging" title="Permalink to this headline">¶</a></h3>
<p>You can specify range of outputted records by <tt class="docutils literal"><span class="pre">offset</span></tt> and <tt class="docutils literal"><span class="pre">limit</span></tt>.
Here is an example to output only the 2nd record.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --offset 1 --limit 1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">offset</span></tt> is zero-based. <tt class="docutils literal"><span class="pre">--offset</span> <span class="pre">1</span></tt> means output range is
started from the 2nd record.</p>
<p><tt class="docutils literal"><span class="pre">limit</span></tt> specifies the max number of output records. <tt class="docutils literal"><span class="pre">--limit</span> <span class="pre">1</span></tt>
means the number of output records is 1 at a maximium. If no records
are matched, <tt class="docutils literal"><span class="pre">select</span></tt> command outputs no records.</p>
</div>
<div class="section" id="the-total-number-of-records">
<h3>7.3.29.3.4. The total number of records<a class="headerlink" href="#the-total-number-of-records" title="Permalink to this headline">¶</a></h3>
<p>You can use <tt class="docutils literal"><span class="pre">--limit</span> <span class="pre">0</span></tt> to retrieve the total number of recrods
without any contents of records.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --limit 0
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">--limit</span> <span class="pre">0</span></tt> is also useful for retrieving only the number of matched
records.</p>
</div>
<div class="section" id="drilldown">
<h3>7.3.29.3.5. Drilldown<a class="headerlink" href="#drilldown" title="Permalink to this headline">¶</a></h3>
<p>You can get additional grouped results against the search result in
one <tt class="docutils literal"><span class="pre">select</span></tt>. You need to use two or more <tt class="docutils literal"><span class="pre">SELECT``s</span> <span class="pre">in</span> <span class="pre">SQL</span> <span class="pre">but</span>
<span class="pre">``select</span></tt> in Groonga can do it in one <tt class="docutils literal"><span class="pre">select</span></tt>.</p>
<p>This feature is called as <a class="reference external" href="http://en.wikipedia.org/wiki/Drill_down">drilldown</a> in Groonga. It's also
called as <a class="reference external" href="http://en.wikipedia.org/wiki/Faceted_search">faceted search</a> in other search
engine.</p>
<p>For example, think about the following situation.</p>
<p>You search entries that has <tt class="docutils literal"><span class="pre">fast</span></tt> word:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --filter &#39;content @ &quot;fast&quot;&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>You want to use <tt class="docutils literal"><span class="pre">tag</span></tt> for additional search condition like
<tt class="docutils literal"><span class="pre">--filter</span> <span class="pre">'content</span> <span class="pre">&#64;</span> <span class="pre">&quot;fast&quot;</span> <span class="pre">&amp;&amp;</span> <span class="pre">tag</span> <span class="pre">==</span> <span class="pre">&quot;???&quot;</span></tt>. But you don't know
suitable tag until you see the result of <tt class="docutils literal"><span class="pre">content</span> <span class="pre">&#64;</span> <span class="pre">&quot;fast&quot;</span></tt>.</p>
<p>If you know the number of matched records of each available tag, you
can choose suitable tag. You can use drilldown for the case:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --filter &#39;content @ &quot;fast&quot;&#39; --drilldown tag
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ],
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">--drilldown</span> <span class="pre">tag</span></tt> returns a list of pair of available tag and the
number of matched records. You can avoid &quot;no hit search&quot; case by
choosing a tag from the list. You can also avoid &quot;too many search
results&quot; case by choosing a tag that the number of matched records is
few from the list.</p>
<p>You can create the following UI with the drilldown results:</p>
<blockquote>
<div><ul class="simple">
<li>Links to narrow search results. (Users don't need to input a
search query by their keyboard. They just click a link.)</li>
</ul>
</div></blockquote>
<p>Most EC sites use the UI. See side menu at Amazon.</p>
<p>Groonga supports not only counting grouped records but also finding
the maximum and/or minimum value from grouped records, summing values
in grouped records and so on. See
<a class="reference internal" href="#select-drilldown-related-parameters"><em>Drilldown related parameters</em></a> for details.</p>
</div>
</div>
<div class="section" id="parameters">
<h2>7.3.29.4. Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>This section describes all parameters. Parameters are categorized.</p>
<div class="section" id="required-parameter">
<h3>7.3.29.4.1. Required parameter<a class="headerlink" href="#required-parameter" title="Permalink to this headline">¶</a></h3>
<p>There is a required parameter, <tt class="docutils literal"><span class="pre">table</span></tt>.</p>
<div class="section" id="table">
<span id="select-table"></span><h4>7.3.29.4.1.1. <tt class="docutils literal"><span class="pre">table</span></tt><a class="headerlink" href="#table" title="Permalink to this headline">¶</a></h4>
<p>It specifies a table to be searched. <tt class="docutils literal"><span class="pre">table</span></tt> must be specified.</p>
<p>If nonexistent table is specified, an error is returned.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Nonexistent
# [
#   [
#     -22,
#     1337566253.89858,
#     0.000355720520019531,
#     &quot;invalid table name: &lt;Nonexistent&gt;&quot;,
#     [
#       [
#         &quot;grn_select&quot;,
#         &quot;proc.c&quot;,
#         1175
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
</div>
</div>
<div class="section" id="search-related-parameters">
<h3>7.3.29.4.2. Search related parameters<a class="headerlink" href="#search-related-parameters" title="Permalink to this headline">¶</a></h3>
<p>There are search related parameters. Typically, <tt class="docutils literal"><span class="pre">match_columns</span></tt> and
<tt class="docutils literal"><span class="pre">query</span></tt> parameters are used for implementing a search
box. <tt class="docutils literal"><span class="pre">filter</span></tt> parameters is used for implementing complex search
feature.</p>
<p>If both <tt class="docutils literal"><span class="pre">query</span></tt> and <tt class="docutils literal"><span class="pre">filter</span></tt> are specified, selected records must
be matched against both <tt class="docutils literal"><span class="pre">query</span></tt> and <tt class="docutils literal"><span class="pre">filter</span></tt>. If both <tt class="docutils literal"><span class="pre">query</span></tt>
and <tt class="docutils literal"><span class="pre">filter</span></tt> aren't specified, all records are selected.</p>
<div class="section" id="match-columns">
<span id="select-match-columns"></span><h4>7.3.29.4.2.1. <tt class="docutils literal"><span class="pre">match_columns</span></tt><a class="headerlink" href="#match-columns" title="Permalink to this headline">¶</a></h4>
<p>It specifies the default target column for fulltext search by
<tt class="docutils literal"><span class="pre">query</span></tt> parameter value. A target column for fulltext search can be
specified in <tt class="docutils literal"><span class="pre">query</span></tt> parameter. The difference between
<tt class="docutils literal"><span class="pre">match_columns</span></tt> and <tt class="docutils literal"><span class="pre">query</span></tt> is whether weight is supported or
not. <tt class="docutils literal"><span class="pre">match_columns</span></tt> supports weight but <tt class="docutils literal"><span class="pre">query</span></tt> doesn't.</p>
<p>Weight is relative importance of target column. A higher weight target
column gets more hit score rather than a lower weight target column
when a record is matched by fulltext search. The default weight is 1.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">match_columns</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query fast --output_columns &#39;_key, _score&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         1
#       ],
#       [
#         &quot;Mroonga&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">--match_columns</span> <span class="pre">content</span></tt> means the default target column for
fulltext search is <tt class="docutils literal"><span class="pre">content</span></tt> column and its weight
is 1. <tt class="docutils literal"><span class="pre">--output_columns</span> <span class="pre">'_key,</span> <span class="pre">_score'</span></tt> means that the <tt class="docutils literal"><span class="pre">select</span></tt>
command outputs <tt class="docutils literal"><span class="pre">_key</span></tt> value and <tt class="docutils literal"><span class="pre">_score</span></tt> value for matched
records.</p>
<p>Pay attention to <tt class="docutils literal"><span class="pre">_score</span></tt> value. <tt class="docutils literal"><span class="pre">_score</span></tt> value is the number of
matched counts against <tt class="docutils literal"><span class="pre">query</span></tt> parameter value. In the example,
<tt class="docutils literal"><span class="pre">query</span></tt> parameter value is <tt class="docutils literal"><span class="pre">fast</span></tt>. The fact that <tt class="docutils literal"><span class="pre">_score</span></tt> value
is 1 means that <tt class="docutils literal"><span class="pre">fast</span></tt> appers in <tt class="docutils literal"><span class="pre">content</span></tt> column only once.  The
fact that <tt class="docutils literal"><span class="pre">_score</span></tt> value is 2 means that <tt class="docutils literal"><span class="pre">fast</span></tt> appears in
<tt class="docutils literal"><span class="pre">content</span></tt> column twice.</p>
<p>To specify weight, <tt class="docutils literal"><span class="pre">column</span> <span class="pre">*</span> <span class="pre">weight</span></tt> syntax is used. Here is a
weight usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns &#39;content * 2&#39; --query fast --output_columns &#39;_key, _score&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ],
#       [
#         &quot;Mroonga&quot;,
#         4
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">--match_columns</span> <span class="pre">'content</span> <span class="pre">*</span> <span class="pre">2'</span></tt> means the default target column for
fulltext search is <tt class="docutils literal"><span class="pre">content</span></tt> column and its weight is 2.</p>
<p>Pay attention to <tt class="docutils literal"><span class="pre">_score</span></tt> value. <tt class="docutils literal"><span class="pre">_score</span></tt> value is doubled because
weight is 2.</p>
<p>You can specify one or more columns as the default target columns for
fulltext search. If one or more columns are specified, fulltext search
is done for all columns and scores are accumulated. If one of the
columns is matched against <tt class="docutils literal"><span class="pre">query</span></tt> parameter value, the record is
treated as matched.</p>
<p>To specify one or more columns, <tt class="docutils literal"><span class="pre">column1</span> <span class="pre">*</span> <span class="pre">weight1</span> <span class="pre">||</span> <span class="pre">column2</span> <span class="pre">*</span>
<span class="pre">weight2</span> <span class="pre">||</span> <span class="pre">...</span></tt> syntax is used. <tt class="docutils literal"><span class="pre">*</span> <span class="pre">weight</span></tt> can be omitted. If it is
omitted, 1 is used for weight. Here is a one or more columns usage
example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns &#39;_key * 10 || content&#39; --query groonga --output_columns &#39;_key, _score&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         11
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">--match_columns</span> <span class="pre">'_key</span> <span class="pre">*</span> <span class="pre">10</span> <span class="pre">||</span> <span class="pre">content'</span></tt> means the default target
columns for fulltext search are <tt class="docutils literal"><span class="pre">_key</span></tt> and <tt class="docutils literal"><span class="pre">content</span></tt> columns and
<tt class="docutils literal"><span class="pre">_key</span></tt> column's weight is 10 and <tt class="docutils literal"><span class="pre">content</span></tt> column's weight
is 1. This weight allocation means <tt class="docutils literal"><span class="pre">_key</span></tt> column value is more
important rather than <tt class="docutils literal"><span class="pre">content</span></tt> column value. In this example, title
of blog entry is more important rather thatn content of blog entry.</p>
</div>
<div class="section" id="query">
<span id="select-query"></span><h4>7.3.29.4.2.2. <tt class="docutils literal"><span class="pre">query</span></tt><a class="headerlink" href="#query" title="Permalink to this headline">¶</a></h4>
<p>It specifies the query text. Normally, it is used for fulltext search
with <tt class="docutils literal"><span class="pre">match_columns</span></tt> parameter. <tt class="docutils literal"><span class="pre">query</span></tt> parameter is designed for
a fulltext search form in a Web page. A query text should be formatted
in <a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a>. The syntax is similar to common search
form like Google's search form. For example, <tt class="docutils literal"><span class="pre">word1</span> <span class="pre">word2</span></tt> means
that groonga searches records that contain both <tt class="docutils literal"><span class="pre">word1</span></tt> and
<tt class="docutils literal"><span class="pre">word2</span></tt>. <tt class="docutils literal"><span class="pre">word1</span> <span class="pre">OR</span> <span class="pre">word2</span></tt> means that groogna searches records that
contain either <tt class="docutils literal"><span class="pre">word1</span></tt> or <tt class="docutils literal"><span class="pre">word2</span></tt>.</p>
<p>Here is a simple logical and search example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query &quot;fast groonga&quot;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain two words
<tt class="docutils literal"><span class="pre">fast</span></tt> and <tt class="docutils literal"><span class="pre">groonga</span></tt> in <tt class="docutils literal"><span class="pre">content</span></tt> column value from <tt class="docutils literal"><span class="pre">Entries</span></tt>
table.</p>
<p>Here is a simple logical or search example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query &quot;groonga OR mroonga&quot;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain one of two words
<tt class="docutils literal"><span class="pre">groonga</span></tt> or <tt class="docutils literal"><span class="pre">mroonga</span></tt> in <tt class="docutils literal"><span class="pre">content</span></tt> column value from
<tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>See <a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a> for other syntax.</p>
<p>It can be used for not only fulltext search but also other
conditions. For example, <tt class="docutils literal"><span class="pre">column:value</span></tt> means the value of
<tt class="docutils literal"><span class="pre">column</span></tt> column is equal to <tt class="docutils literal"><span class="pre">value</span></tt>. <tt class="docutils literal"><span class="pre">column:&lt;value</span></tt> means the
value of <tt class="docutils literal"><span class="pre">column</span></tt> column is less than <tt class="docutils literal"><span class="pre">value</span></tt>.</p>
<p>Here is a simple equality operator search example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --query _key:Groonga
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that <tt class="docutils literal"><span class="pre">_key</span></tt> column value is
<tt class="docutils literal"><span class="pre">Groonga</span></tt> from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>Here is a simple less than operator search example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --query n_likes:&lt;11
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         4
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value
is less than <tt class="docutils literal"><span class="pre">11</span></tt> from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>See <a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a> for other operations.</p>
</div>
<div class="section" id="filter">
<span id="select-filter"></span><h4>7.3.29.4.2.3. <tt class="docutils literal"><span class="pre">filter</span></tt><a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h4>
<p>It specifies the filter text. Normally, it is used for complex search
conditions. <tt class="docutils literal"><span class="pre">filter</span></tt> can be used with <tt class="docutils literal"><span class="pre">query</span></tt> parameter. If both
<tt class="docutils literal"><span class="pre">filter</span></tt> and <tt class="docutils literal"><span class="pre">query</span></tt> are specified, there are conbined with
logical and. It means that matched records should be matched against
both <tt class="docutils literal"><span class="pre">filter</span></tt> and <tt class="docutils literal"><span class="pre">query</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">filter</span></tt> parameter is designed for complex conditions. A filter text
should be formated in <a class="reference internal" href="../grn_expr/script_syntax.html"><em>Script syntax</em></a>. The syntax is
similar to ECMAScript. For example, <tt class="docutils literal"><span class="pre">column</span> <span class="pre">==</span> <span class="pre">&quot;value&quot;</span></tt> means that
the value of <tt class="docutils literal"><span class="pre">column</span></tt> column is equal to <tt class="docutils literal"><span class="pre">&quot;value&quot;</span></tt>. <tt class="docutils literal"><span class="pre">column</span> <span class="pre">&lt;</span>
<span class="pre">value</span></tt> means that the value of <tt class="docutils literal"><span class="pre">column</span></tt> column is less than
<tt class="docutils literal"><span class="pre">value</span></tt>.</p>
<p>Here is a simple equality operator search example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --filter &#39;_key == &quot;Groonga&quot;&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that <tt class="docutils literal"><span class="pre">_key</span></tt> column value is
<tt class="docutils literal"><span class="pre">Groonga</span></tt> from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>Here is a simple less than operator search example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --filter &#39;n_likes &lt; 11&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         4
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value
is less than <tt class="docutils literal"><span class="pre">11</span></tt> from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>See <a class="reference internal" href="../grn_expr/script_syntax.html"><em>Script syntax</em></a> for other operators.</p>
</div>
</div>
<div class="section" id="advanced-search-parameters">
<h3>7.3.29.4.3. Advanced search parameters<a class="headerlink" href="#advanced-search-parameters" title="Permalink to this headline">¶</a></h3>
<div class="section" id="match-escalation-threshold">
<span id="id2"></span><h4>7.3.29.4.3.1. <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt><a class="headerlink" href="#match-escalation-threshold" title="Permalink to this headline">¶</a></h4>
<p>It specifies threshold to determine whether search storategy
escalation is used or not. The threshold is compared against the
number of matched records. If the number of matched records is equal
to or less than the threshold, the search storategy escalation is
used. See <a class="reference internal" href="../../spec/search.html"><em>検索</em></a> about the search storategy escalation.</p>
<p>The default threshold is 0. It means that search storategy escalation
is used only when no records are matched.</p>
<p>The default threshold can be customized by one of the followings.</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">--with-match-escalation-threshold</span></tt> option of configure</li>
<li><tt class="docutils literal"><span class="pre">--match-escalation-threshold</span></tt> option of groogna command</li>
<li><tt class="docutils literal"><span class="pre">match-escalation-threshold</span></tt> configuration item in configuration
file</li>
</ul>
</div></blockquote>
<p>Here is a simple <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt> usage example. The
first <tt class="docutils literal"><span class="pre">select</span></tt> doesn't have <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt>
parameter. The second <tt class="docutils literal"><span class="pre">select</span></tt> has <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt>
parameter.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query groo
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
select Entries --match_columns content --query groo --match_escalation_threshold -1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         0
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The first <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain a word
<tt class="docutils literal"><span class="pre">groo</span></tt> in <tt class="docutils literal"><span class="pre">content</span></tt> column value from <tt class="docutils literal"><span class="pre">Entries</span></tt> table. But no
records are matched because the <tt class="docutils literal"><span class="pre">TokenBigram</span></tt> tokenizer tokenizes
<tt class="docutils literal"><span class="pre">groonga</span></tt> to <tt class="docutils literal"><span class="pre">groonga</span></tt> not <tt class="docutils literal"><span class="pre">gr|ro|oo|on|ng|ga</span></tt>. (The
<tt class="docutils literal"><span class="pre">TokenBigramSplitSymbolAlpha</span></tt> tokenizer tokenizes <tt class="docutils literal"><span class="pre">groonga</span></tt> to
<tt class="docutils literal"><span class="pre">gr|ro|oo|on|ng|ga</span></tt>. See <a class="reference internal" href="../tokenizers.html"><em>Tokenizers</em></a> for details.)
It means that <tt class="docutils literal"><span class="pre">groonga</span></tt> is indexed but <tt class="docutils literal"><span class="pre">groo</span></tt> isn't indexed. So no
records are matched against <tt class="docutils literal"><span class="pre">groo</span></tt> by exact match. In the case, the
search storategy escalation is used because the number of matched
records (0) is equal to <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt> (0). One record
is matched against <tt class="docutils literal"><span class="pre">groo</span></tt> by unsplit search.</p>
<p>The second <tt class="docutils literal"><span class="pre">select</span></tt> command also searches records that contain a
word <tt class="docutils literal"><span class="pre">groo</span></tt> in <tt class="docutils literal"><span class="pre">content</span></tt> column value from <tt class="docutils literal"><span class="pre">Entries</span></tt> table. And
it also doesn't found matched records. In this case, the search
storategy escalation is not used because the number of matched
records (0) is larger than <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt> (-1). So no
more searches aren't executed. And no records are matched.</p>
</div>
<div class="section" id="query-expansion">
<span id="id3"></span><h4>7.3.29.4.3.2. <tt class="docutils literal"><span class="pre">query_expansion</span></tt><a class="headerlink" href="#query-expansion" title="Permalink to this headline">¶</a></h4>
<p>Deprecated. Use <a class="reference internal" href="#query-expander"><em>query_expander</em></a> instead.</p>
</div>
<div class="section" id="query-flags">
<span id="id4"></span><h4>7.3.29.4.3.3. <tt class="docutils literal"><span class="pre">query_flags</span></tt><a class="headerlink" href="#query-flags" title="Permalink to this headline">¶</a></h4>
<p>It customs <tt class="docutils literal"><span class="pre">query</span></tt> parameter syntax. You cannot update column value
by <tt class="docutils literal"><span class="pre">query</span></tt> parameter by default. But if you specify
<tt class="docutils literal"><span class="pre">ALLOW_COLUMN|ALLOW_UPDATE</span></tt> as <tt class="docutils literal"><span class="pre">query_flags</span></tt>, you can update
column value by <tt class="docutils literal"><span class="pre">query</span></tt>.</p>
<p>Here are available values:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ALLOW_PRAGMA</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ALLOW_COLUMN</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ALLOW_UPDATE</span></tt></li>
<li><tt class="docutils literal"><span class="pre">ALLOW_LEADING_NOT</span></tt></li>
<li><tt class="docutils literal"><span class="pre">NONE</span></tt></li>
</ul>
<p><tt class="docutils literal"><span class="pre">ALLOW_PRAGMA</span></tt> enables pragma at the head of <tt class="docutils literal"><span class="pre">query</span></tt>. This is not
implemented yet.</p>
<p><tt class="docutils literal"><span class="pre">ALLOW_COLUMN</span></tt> enables search againt columns that are not included
in <tt class="docutils literal"><span class="pre">match_columns</span></tt>. To specify column, there are <tt class="docutils literal"><span class="pre">COLUMN:...</span></tt>
syntaxes.</p>
<p><tt class="docutils literal"><span class="pre">ALLOW_UPDATE</span></tt> enables column update by <tt class="docutils literal"><span class="pre">query</span></tt> with
<tt class="docutils literal"><span class="pre">COLUMN:=NEW_VALUE</span></tt> syntax. <tt class="docutils literal"><span class="pre">ALLOW_COLUMN</span></tt> is also required to
update column because the column update syntax specifies column.</p>
<p><tt class="docutils literal"><span class="pre">ALLOW_LEADING_NOT</span></tt> enables leading NOT condition with <tt class="docutils literal"><span class="pre">-WORD</span></tt>
syntax. The query searches records that doesn't match
<tt class="docutils literal"><span class="pre">WORD</span></tt>. Leading NOT condition query is heavy query in many cases
because it matches many records. So this flag is disabled by
default. Be careful about it when you use the flag.</p>
<p><tt class="docutils literal"><span class="pre">NONE</span></tt> is just ignores. You can use <tt class="docutils literal"><span class="pre">NONE</span></tt> for specifying no flags.</p>
<p>They can be combined by separated <tt class="docutils literal"><span class="pre">|</span></tt> such as
<tt class="docutils literal"><span class="pre">ALLOW_COLUMN|ALLOW_UPDATE</span></tt>.</p>
<p>The default value is <tt class="docutils literal"><span class="pre">ALLOW_PRAGMA|ALLOW_COLUMN</span></tt>.</p>
<p>Here is a usage example of <tt class="docutils literal"><span class="pre">ALLOW_COLUMN</span></tt>.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --query content:@mroonga --query_flags ALLOW_COLUMN
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain <tt class="docutils literal"><span class="pre">mroonga</span></tt> in
<tt class="docutils literal"><span class="pre">content</span></tt> column value from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>Here is a usage example of <tt class="docutils literal"><span class="pre">ALLOW_UPDATE</span></tt>.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>table_create Users TABLE_HASH_KEY ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Users age COLUMN_SCALAR UInt32
# [[0, 1337566253.89858, 0.000355720520019531], true]
load --table Users
[
{&quot;_key&quot;: &quot;alice&quot;, &quot;age&quot;: 18},
{&quot;_key&quot;: &quot;bob&quot;,   &quot;age&quot;: 20}
]
# [[0, 1337566253.89858, 0.000355720520019531], 2]
select Users --query age:=19 --query_flags ALLOW_COLUMN|ALLOW_UPDATE
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;age&quot;,
#           &quot;UInt32&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;alice&quot;,
#         19
#       ],
#       [
#         2,
#         &quot;bob&quot;,
#         19
#       ]
#     ]
#   ]
# ]
select Users
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;age&quot;,
#           &quot;UInt32&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;alice&quot;,
#         19
#       ],
#       [
#         2,
#         &quot;bob&quot;,
#         19
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The first <tt class="docutils literal"><span class="pre">select</span></tt> command sets <tt class="docutils literal"><span class="pre">age</span></tt> column value of all records
to <tt class="docutils literal"><span class="pre">19</span></tt>. The second <tt class="docutils literal"><span class="pre">select</span></tt> command outputs updated <tt class="docutils literal"><span class="pre">age</span></tt>
column values.</p>
<p>Here is a usage example of <tt class="docutils literal"><span class="pre">ALLOW_LEADING_NOT</span></tt>.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query -mroonga --query_flags ALLOW_LEADING_NOT
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         4
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that don't contain <tt class="docutils literal"><span class="pre">mroonga</span></tt>
in <tt class="docutils literal"><span class="pre">content</span></tt> column value from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
<p>Here is a usage example of <tt class="docutils literal"><span class="pre">NONE</span></tt>.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query &#39;mroonga OR _key:Groonga&#39; --query_flags NONE
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command searches records that contain one of two words
<tt class="docutils literal"><span class="pre">mroonga</span></tt> or <tt class="docutils literal"><span class="pre">_key:Groonga</span></tt> in <tt class="docutils literal"><span class="pre">content</span></tt> from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.
Note that <tt class="docutils literal"><span class="pre">_key:Groonga</span></tt> doesn't mean that the value of <tt class="docutils literal"><span class="pre">_key</span></tt>
column is equal to <tt class="docutils literal"><span class="pre">Groonga</span></tt>. Because <tt class="docutils literal"><span class="pre">ALLOW_COLUMN</span></tt> flag is not
specified.</p>
<p>See also <a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a>.</p>
</div>
<div class="section" id="query-expander">
<span id="id5"></span><h4>7.3.29.4.3.4. <tt class="docutils literal"><span class="pre">query_expander</span></tt><a class="headerlink" href="#query-expander" title="Permalink to this headline">¶</a></h4>
<p>It's for query expansion. Query expansion substitutes specific words
to another words in query. Nomally, it's used for synonym search.</p>
<p>It specifies a column that is used to substitute <tt class="docutils literal"><span class="pre">query</span></tt> parameter
value. The format of this parameter value is
&quot;<tt class="docutils literal"><span class="pre">${TABLE}.${COLUMN}</span></tt>&quot;. For example, &quot;<tt class="docutils literal"><span class="pre">Terms.synonym</span></tt>&quot; specifies
<tt class="docutils literal"><span class="pre">synonym</span></tt> column in <tt class="docutils literal"><span class="pre">Terms</span></tt> table.</p>
<p>Table for query expansion is called &quot;substitution table&quot;. Substitution
table's key must be <tt class="docutils literal"><span class="pre">ShortText</span></tt>. So array table (<tt class="docutils literal"><span class="pre">TABLE_NO_KEY</span></tt>)
can't be used for query expansion. Because array table doesn't have
key.</p>
<p>Column for query expansion is called &quot;substitution
column&quot;. Substitution column's value type must be
<tt class="docutils literal"><span class="pre">ShortText</span></tt>. Column type must be vector (<tt class="docutils literal"><span class="pre">COLUMN_VECTOR</span></tt>).</p>
<p>Query expansion substitutes key of substitution table in query with
values in substitution column. If a word in <tt class="docutils literal"><span class="pre">query</span></tt> is a key of
substitution table, the word is substituted with substitution column
value that is associated with the key. Substition isn't performed
recursively. It means that substitution target words in substituted
query aren't substituted.</p>
<p>Here is a sample substitution table to show a simple
<tt class="docutils literal"><span class="pre">query_expander</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>table_create Thesaurus TABLE_PAT_KEY|KEY_NORMALIZE ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Thesaurus synonym COLUMN_VECTOR ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
load --table Thesaurus
[
{&quot;_key&quot;: &quot;mroonga&quot;, &quot;synonym&quot;: [&quot;mroonga&quot;, &quot;tritonn&quot;, &quot;groonga mysql&quot;]},
{&quot;_key&quot;: &quot;groonga&quot;, &quot;synonym&quot;: [&quot;groonga&quot;, &quot;senna&quot;]}
]
# [[0, 1337566253.89858, 0.000355720520019531], 2]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">Thesaurus</span></tt> substitution table has two synonyms, <tt class="docutils literal"><span class="pre">&quot;mroonga&quot;</span></tt> and
<tt class="docutils literal"><span class="pre">&quot;groonga&quot;</span></tt>. If an user searches with <tt class="docutils literal"><span class="pre">&quot;mroonga&quot;</span></tt>, groonga
searches with <tt class="docutils literal"><span class="pre">&quot;((mroonga)</span> <span class="pre">OR</span> <span class="pre">(tritonn)</span> <span class="pre">OR</span> <span class="pre">(groonga</span> <span class="pre">mysql))&quot;</span></tt>. If an
user searches with <tt class="docutils literal"><span class="pre">&quot;groonga&quot;</span></tt>, groonga searches with <tt class="docutils literal"><span class="pre">&quot;((groonga)</span>
<span class="pre">OR</span> <span class="pre">(senna))&quot;</span></tt>. Nomrally, it's good idea that substitution table has
<tt class="docutils literal"><span class="pre">KEY_NORMALIZE</span></tt> flag. If the flag is used, substitute target word is
matched in case insensitive manner.</p>
<p>Note that those synonym values include the key value such as
<tt class="docutils literal"><span class="pre">&quot;mroonga&quot;</span></tt> and <tt class="docutils literal"><span class="pre">&quot;groonga&quot;</span></tt>. It's recommended that you include the
key value. If you don't include key value, substituted value doesn't
include the original substitute target value. Normally, including the
original value is better search result. If you have a word that you
don't want to be searched, you should not include the original
word. For example, you can implement &quot;stop words&quot; by an empty vector
value.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">query_expander</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query &quot;mroonga&quot;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         1
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
select Entries --match_columns content --query &quot;mroonga&quot; --query_expander Thesaurus.synonym
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
select Entries --match_columns content --query &quot;((mroonga) OR (tritonn) OR (groonga mysql))&quot;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The first <tt class="docutils literal"><span class="pre">select</span></tt> command doesn't use query expansion. So a record
that has <tt class="docutils literal"><span class="pre">&quot;tritonn&quot;</span></tt> isn't found. The second <tt class="docutils literal"><span class="pre">select</span></tt> command uses
query expansion. So a record that has <tt class="docutils literal"><span class="pre">&quot;tritonn&quot;</span></tt> is found. The
third <tt class="docutils literal"><span class="pre">select</span></tt> command doesn't use query expansion but it is same as
the second <tt class="docutils literal"><span class="pre">select</span></tt> command. The third one uses expanded query.</p>
<p>Each substitute value can contain any <a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a> syntax
such as <tt class="docutils literal"><span class="pre">(...)</span></tt> and <tt class="docutils literal"><span class="pre">OR</span></tt>. You can use complex substitution by
using those syntax.</p>
<p>Here is a complex substitution usage example that uses query syntax.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>load --table Thesaurus
[
{&quot;_key&quot;: &quot;popular&quot;, &quot;synonym&quot;: [&quot;popular&quot;, &quot;n_likes:&gt;=10&quot;]}
]
# [[0, 1337566253.89858, 0.000355720520019531], 1]
select Entries --match_columns content --query &quot;popular&quot; --query_expander Thesaurus.synonym
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">load</span></tt> command registers a new synonym <tt class="docutils literal"><span class="pre">&quot;popular&quot;</span></tt>. It is
substituted with <tt class="docutils literal"><span class="pre">((popular)</span> <span class="pre">OR</span> <span class="pre">(n_likes:&gt;=10))</span></tt>. The substituted
query means that &quot;popular&quot; is containing the word &quot;popular&quot; or 10 or
more liked entries.</p>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs records that <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value
is equal to or more than <tt class="docutils literal"><span class="pre">10</span></tt> from <tt class="docutils literal"><span class="pre">Entries</span></tt> table.</p>
</div>
</div>
<div class="section" id="output-related-parameters">
<h3>7.3.29.4.4. Output related parameters<a class="headerlink" href="#output-related-parameters" title="Permalink to this headline">¶</a></h3>
<div class="section" id="output-columns">
<span id="select-output-columns"></span><h4>7.3.29.4.4.1. <tt class="docutils literal"><span class="pre">output_columns</span></tt><a class="headerlink" href="#output-columns" title="Permalink to this headline">¶</a></h4>
<p>It specifies output columns separated by <tt class="docutils literal"><span class="pre">,</span></tt>.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">output_columns</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --output_columns &#39;_id, _key&#39; --limit 1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command just outputs <tt class="docutils literal"><span class="pre">_id</span></tt> and <tt class="docutils literal"><span class="pre">_key</span></tt> column
values.</p>
<p><tt class="docutils literal"><span class="pre">*</span></tt> is a special value. It means that all columns that are not
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a>.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">*</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --output_columns &#39;_key, *&#39; --limit 1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs <tt class="docutils literal"><span class="pre">_key</span></tt> pseudo column, <tt class="docutils literal"><span class="pre">content</span></tt>
column and <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values but doesn't output <tt class="docutils literal"><span class="pre">_id</span></tt> pseudo
column value.</p>
<p>The default value is <tt class="docutils literal"><span class="pre">_id,</span> <span class="pre">_key,</span> <span class="pre">*</span></tt>. It means that all column
values except <tt class="docutils literal"><span class="pre">_score</span></tt> are outputted.</p>
</div>
<div class="section" id="sortby">
<span id="select-sortby"></span><h4>7.3.29.4.4.2. <tt class="docutils literal"><span class="pre">sortby</span></tt><a class="headerlink" href="#sortby" title="Permalink to this headline">¶</a></h4>
<p>It specifies sort keys separated by <tt class="docutils literal"><span class="pre">,</span></tt>. Each sort key is column
name.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">sortby</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --sortby &#39;n_likes, _id&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command sorts by <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value in ascending
order. For records that has the same <tt class="docutils literal"><span class="pre">n_likes</span></tt> are sorted by <tt class="docutils literal"><span class="pre">_id</span></tt>
in ascending order. <tt class="docutils literal"><span class="pre">&quot;Good-bye</span> <span class="pre">Senna&quot;</span></tt> and <tt class="docutils literal"><span class="pre">&quot;Good-bye</span> <span class="pre">Tritonn&quot;</span></tt>
are the case.</p>
<p>If you want to sort in descending order, add <tt class="docutils literal"><span class="pre">-</span></tt> before column name.</p>
<p>Here is a descending order <tt class="docutils literal"><span class="pre">sortby</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --sortby &#39;-n_likes, _id&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command sorts by <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value in descending
order. But ascending order is used for sorting by <tt class="docutils literal"><span class="pre">_id</span></tt>.</p>
<p>You can use <tt class="docutils literal"><span class="pre">_score</span></tt> pseudo column in <tt class="docutils literal"><span class="pre">sortby</span></tt> if you use
<tt class="docutils literal"><span class="pre">query</span></tt> or <tt class="docutils literal"><span class="pre">filter</span></tt> parameter.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --match_columns content --query fast --sortby -_score --output_columns &#39;_key, _score&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Mroonga&quot;,
#         2
#       ],
#       [
#         &quot;Groonga&quot;,
#         1
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command sorts matched records by hit score in
descending order and outputs record key and hit score.</p>
<p>If you use <tt class="docutils literal"><span class="pre">_score</span></tt> without <tt class="docutils literal"><span class="pre">query</span></tt> nor <tt class="docutils literal"><span class="pre">filter</span></tt> parameters,
it's just ignored but get a warning in log file.</p>
</div>
<div class="section" id="offset">
<span id="select-offset"></span><h4>7.3.29.4.4.3. <tt class="docutils literal"><span class="pre">offset</span></tt><a class="headerlink" href="#offset" title="Permalink to this headline">¶</a></h4>
<p>It specifies offset to determine output records range. Offset is
zero-based. <tt class="docutils literal"><span class="pre">--offset</span> <span class="pre">1</span></tt> means output range is started from the 2nd
record.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --sortby _id --offset 3 --output_columns _key
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;Good-bye Senna&quot;
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs from the 4th record.</p>
<p>You can specify negative value. It means that <tt class="docutils literal"><span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">matched</span>
<span class="pre">records</span> <span class="pre">+</span> <span class="pre">offset</span></tt>. If you have 3 matched records and specify
<tt class="docutils literal"><span class="pre">--offset</span> <span class="pre">-2</span></tt>, you get records from the 2nd (<tt class="docutils literal"><span class="pre">3</span> <span class="pre">+</span> <span class="pre">-2</span> <span class="pre">=</span> <span class="pre">1</span></tt>. <tt class="docutils literal"><span class="pre">1</span></tt>
means 2nd. Remember that offset is zero-based.) record to the 3rd
record.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --sortby _id --offset -2 --output_columns _key
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;Good-bye Senna&quot;
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs from the 4th record because the total
number of records is <tt class="docutils literal"><span class="pre">5</span></tt>.</p>
<p>The default value is <tt class="docutils literal"><span class="pre">0</span></tt>.</p>
</div>
<div class="section" id="limit">
<h4>7.3.29.4.4.4. <tt class="docutils literal"><span class="pre">limit</span></tt><a class="headerlink" href="#limit" title="Permalink to this headline">¶</a></h4>
<p>It specifies the max number of output records. If the number of
matched records is less than <tt class="docutils literal"><span class="pre">limit</span></tt>, all records are outputted.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">limit</span></tt> usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --sortby _id --offset 2 --limit 3 --output_columns _key
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;Mroonga&quot;
#       ],
#       [
#         &quot;Good-bye Senna&quot;
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs the 3rd, the 4th and the 5th records.</p>
<p>You can specify negative value. It means that <tt class="docutils literal"><span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">matched</span>
<span class="pre">records</span> <span class="pre">+</span> <span class="pre">limit</span> <span class="pre">+</span> <span class="pre">1</span></tt>. For example, <tt class="docutils literal"><span class="pre">--limit</span> <span class="pre">-1</span></tt> outputs all
records. It's very useful value to show all records.</p>
<p>Here is a simple negative <tt class="docutils literal"><span class="pre">limit</span></tt> value usage example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries --limit -1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs all records.</p>
<p>The default value is <tt class="docutils literal"><span class="pre">10</span></tt>.</p>
</div>
<div class="section" id="scorer">
<h4>7.3.29.4.4.5. <tt class="docutils literal"><span class="pre">scorer</span></tt><a class="headerlink" href="#scorer" title="Permalink to this headline">¶</a></h4>
<p>TODO: write in English and add example.</p>
<p>検索条件にマッチする全てのレコードに対して適用するgrn_exprをscript形式で指定します。</p>
<p>scorerは、検索処理が完了し、ソート処理が実行される前に呼び出されます。従って、各レコードのスコアを操作する式を指定しておけば、検索結果のソート順序をカスタマイズできるようになります。</p>
</div>
</div>
<div class="section" id="drilldown-related-parameters">
<span id="select-drilldown-related-parameters"></span><h3>7.3.29.4.5. Drilldown related parameters<a class="headerlink" href="#drilldown-related-parameters" title="Permalink to this headline">¶</a></h3>
<p>This section describes basic drilldown related parameters. Advanced
drilldown related parameters are described in another section.</p>
<div class="section" id="select-drilldown">
<span id="id6"></span><h4>7.3.29.4.5.1. <tt class="docutils literal"><span class="pre">drilldown</span></tt><a class="headerlink" href="#select-drilldown" title="Permalink to this headline">¶</a></h4>
<p>It specifies keys for grouping separated by <tt class="docutils literal"><span class="pre">,</span></tt>.</p>
<p>Matched records by specified search conditions are grouped by each
key. If you specify no search condition, all records are grouped by
each key.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">drilldown</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --output_columns _key,tag \
  --drilldown tag
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;The first post!&quot;,
#         &quot;Hello&quot;
#       ],
#       [
#         &quot;Groonga&quot;,
#         &quot;Groonga&quot;
#       ],
#       [
#         &quot;Mroonga&quot;,
#         &quot;Groonga&quot;
#       ],
#       [
#         &quot;Good-bye Senna&quot;,
#         &quot;Senna&quot;
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;,
#         &quot;Senna&quot;
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs the following information:</p>
<blockquote>
<div><ul class="simple">
<li>There is one record that has &quot;Hello&quot; tag.</li>
<li>There is two records that has &quot;Groonga&quot; tag.</li>
<li>There is two records that has &quot;Senna&quot; tag.</li>
</ul>
</div></blockquote>
<p>Here is a <tt class="docutils literal"><span class="pre">drilldown</span></tt> with search condition example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --output_columns _key,tag \
  --filter &#39;n_likes &gt;= 5&#39; \
  --drilldown tag
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;The first post!&quot;,
#         &quot;Hello&quot;
#       ],
#       [
#         &quot;Groonga&quot;,
#         &quot;Groonga&quot;
#       ],
#       [
#         &quot;Mroonga&quot;,
#         &quot;Groonga&quot;
#       ]
#     ],
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs the following information:</p>
<blockquote>
<div><ul class="simple">
<li>In records that have 5 or larger as <tt class="docutils literal"><span class="pre">n_likes</span></tt> value:<ul>
<li>There is one record that has &quot;Hello&quot; tag.</li>
<li>There is two records that has &quot;Groonga&quot; tag.</li>
</ul>
</li>
</ul>
</div></blockquote>
<p>Here is a <tt class="docutils literal"><span class="pre">drilldown</span></tt> with multiple group keys example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown tag,n_likes
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ]
#     ],
#     [
#       [
#         4
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         5,
#         1
#       ],
#       [
#         10,
#         1
#       ],
#       [
#         15,
#         1
#       ],
#       [
#         3,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs the following information:</p>
<blockquote>
<div><ul class="simple">
<li>About <tt class="docutils literal"><span class="pre">tag</span></tt>:<ul>
<li>There is one record that has &quot;Hello&quot; tag.</li>
<li>There is two records that has &quot;Groonga&quot; tag.</li>
<li>There is two records that has &quot;Senna&quot; tag.</li>
</ul>
</li>
<li>About <tt class="docutils literal"><span class="pre">n_likes</span></tt>:<ul>
<li>There is one record that has &quot;Hello&quot; tag.</li>
<li>There is two records that has &quot;Groonga&quot; tag.</li>
<li>There is two records that has &quot;Senna&quot; tag.</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="drilldown-sortby">
<span id="select-drilldown-sortby"></span><h4>7.3.29.4.5.2. <tt class="docutils literal"><span class="pre">drilldown_sortby</span></tt><a class="headerlink" href="#drilldown-sortby" title="Permalink to this headline">¶</a></h4>
<p>It specifies sort keys for drilldown outputs separated by <tt class="docutils literal"><span class="pre">,</span></tt>. Each
sort key is column name.</p>
<p>You can refer the number of grouped records by <tt class="docutils literal"><span class="pre">_nsubrecs</span></tt>
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a>.</p>
<p>Here is a simple <tt class="docutils literal"><span class="pre">drilldown_sortby</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown &#39;tag, n_likes&#39; \
  --drilldown_sortby &#39;-_nsubrecs, _key&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ]
#     ],
#     [
#       [
#         4
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         3,
#         2
#       ],
#       [
#         5,
#         1
#       ],
#       [
#         10,
#         1
#       ],
#       [
#         15,
#         1
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>Drilldown result is sorted by the number of grouped records (=
<tt class="docutils literal"><span class="pre">_nsubrecs</span></tt> ) in descending order. If there are grouped results that
the number of records in the group are the same, these grouped results
are sorted by grouped key (= <tt class="docutils literal"><span class="pre">_key</span></tt> ) in ascending order.</p>
<p>The sort keys are used in all group keys specified in <tt class="docutils literal"><span class="pre">drilldown</span></tt>:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown &#39;tag, n_likes&#39; \
  --drilldown_sortby &#39;-_nsubrecs, _key&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ]
#     ],
#     [
#       [
#         4
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         3,
#         2
#       ],
#       [
#         5,
#         1
#       ],
#       [
#         10,
#         1
#       ],
#       [
#         15,
#         1
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The same sort keys are used in <tt class="docutils literal"><span class="pre">tag</span></tt> drilldown and <tt class="docutils literal"><span class="pre">n_likes</span></tt>
drilldown.</p>
<p>If you want to use different sort keys for each drilldown, use
<a class="reference internal" href="#select-advanced-drilldown-related-parameters"><em>Advanced drilldown related parameters</em></a>.</p>
</div>
<div class="section" id="drilldown-output-columns">
<span id="select-drilldown-output-columns"></span><h4>7.3.29.4.5.3. <tt class="docutils literal"><span class="pre">drilldown_output_columns</span></tt><a class="headerlink" href="#drilldown-output-columns" title="Permalink to this headline">¶</a></h4>
<p>It specifies output columns for drilldown separated by <tt class="docutils literal"><span class="pre">,</span></tt>.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">drilldown_output_columns</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_output_columns _key
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;
#       ],
#       [
#         &quot;Groonga&quot;
#       ],
#       [
#         &quot;Senna&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command just outputs grouped key.</p>
<p>If grouped key is a referenced type column (= column that its type is
a table), you can access column of the table referenced by the
referenced type column.</p>
<p>Here are a schema definition and sample data to show drilldown against
referenced type column:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>table_create Tags TABLE_HASH_KEY ShortText --normalizer NormalizerAuto
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Tags label COLUMN_SCALAR ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Tags priority COLUMN_SCALAR Int32
# [[0, 1337566253.89858, 0.000355720520019531], true]
table_create Items TABLE_HASH_KEY ShortText
# [[0, 1337566253.89858, 0.000355720520019531], true]
column_create Items tag COLUMN_SCALAR Tags
# [[0, 1337566253.89858, 0.000355720520019531], true]
load --table Tags
[
{&quot;_key&quot;: &quot;groonga&quot;, label: &quot;Groonga&quot;, priority: 10},
{&quot;_key&quot;: &quot;mroonga&quot;, label: &quot;Mroonga&quot;, priority: 5}
]
# [[0, 1337566253.89858, 0.000355720520019531], 2]
load --table Items
[
{&quot;_key&quot;: &quot;A&quot;, &quot;tag&quot;: &quot;groonga&quot;},
{&quot;_key&quot;: &quot;B&quot;, &quot;tag&quot;: &quot;groonga&quot;},
{&quot;_key&quot;: &quot;C&quot;, &quot;tag&quot;: &quot;mroonga&quot;}
]
# [[0, 1337566253.89858, 0.000355720520019531], 3]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">Tags</span></tt> table is a referenced table. <tt class="docutils literal"><span class="pre">Items.tag</span></tt> is a referenced
type column.</p>
<p>You can refer <tt class="docutils literal"><span class="pre">Tags.label</span></tt> by <tt class="docutils literal"><span class="pre">label</span></tt> in
<tt class="docutils literal"><span class="pre">drilldown_output_columns</span></tt>:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Items \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_output_columns &#39;_key, label&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;Tags&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;label&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         &quot;groonga&quot;,
#         &quot;Groonga&quot;
#       ],
#       [
#         &quot;mroonga&quot;,
#         &quot;Mroonga&quot;
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>You can use <tt class="docutils literal"><span class="pre">*</span></tt> to refer all columns in referenced table (= <tt class="docutils literal"><span class="pre">Tags</span></tt>):</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Items \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_output_columns &#39;_key, *&#39;
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;Tags&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         2
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;label&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;priority&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;groonga&quot;,
#         &quot;Groonga&quot;,
#         10
#       ],
#       [
#         &quot;mroonga&quot;,
#         &quot;Mroonga&quot;,
#         5
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">*</span></tt> is expanded to <tt class="docutils literal"><span class="pre">label,</span> <span class="pre">priority</span></tt>.</p>
<p>The default value of <tt class="docutils literal"><span class="pre">drilldown_output_columns</span></tt> is <tt class="docutils literal"><span class="pre">_key,</span>
<span class="pre">_nsubrecs</span></tt>. It means that grouped key and the number of records in
the group are output.</p>
<p>You can use more <a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> in
<tt class="docutils literal"><span class="pre">drilldown_output_columns</span></tt> such as <tt class="docutils literal"><span class="pre">_max</span></tt>, <tt class="docutils literal"><span class="pre">_min</span></tt>, <tt class="docutils literal"><span class="pre">_sum</span></tt> and
<tt class="docutils literal"><span class="pre">_avg</span></tt> when you use <a class="reference internal" href="#select-drilldown-calc-types"><em>drilldown_calc_types</em></a>. See
<tt class="docutils literal"><span class="pre">drilldown_calc_types</span></tt> document for details.</p>
</div>
<div class="section" id="drilldown-offset">
<span id="select-drilldown-offset"></span><h4>7.3.29.4.5.4. <tt class="docutils literal"><span class="pre">drilldown_offset</span></tt><a class="headerlink" href="#drilldown-offset" title="Permalink to this headline">¶</a></h4>
<p>It specifies offset to determine range of drilldown output
records. Offset is zero-based. <tt class="docutils literal"><span class="pre">--drilldown_offset</span> <span class="pre">1</span></tt> means output
range is started from the 2nd record.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">drilldown_offset</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_sortby _key \
  --drilldown_offset 1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs from the 2nd record.</p>
<p>You can specify negative value. It means that <tt class="docutils literal"><span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">grouped</span>
<span class="pre">results</span> <span class="pre">+</span> <span class="pre">offset</span></tt>. If you have 3 grouped results and specify
<tt class="docutils literal"><span class="pre">--drilldown_offset</span> <span class="pre">-2</span></tt>, you get grouped results from the 2st
(<tt class="docutils literal"><span class="pre">3</span> <span class="pre">+</span> <span class="pre">-2</span> <span class="pre">=</span> <span class="pre">1</span></tt>. <tt class="docutils literal"><span class="pre">1</span></tt> means 2nd. Remember that offset is zero-based.)
grouped result to the 3rd grouped result.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_sortby _key \
  --drilldown_offset -2
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs from the 2nd grouped result because the
total number of grouped results is <tt class="docutils literal"><span class="pre">3</span></tt>.</p>
<p>The default value of <tt class="docutils literal"><span class="pre">drilldown_offset</span></tt> is <tt class="docutils literal"><span class="pre">0</span></tt>.</p>
</div>
<div class="section" id="drilldown-limit">
<span id="select-drilldown-limit"></span><h4>7.3.29.4.5.5. <tt class="docutils literal"><span class="pre">drilldown_limit</span></tt><a class="headerlink" href="#drilldown-limit" title="Permalink to this headline">¶</a></h4>
<p>It specifies the max number of groups in a drilldown. If the number of
groups is less than <tt class="docutils literal"><span class="pre">drilldown_limit</span></tt>, all groups are outputted.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">drilldown_limit</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_sortby _key \
  --drilldown_offset 1 \
  --drilldown_limit 2
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs the 2rd and the 3rd groups.</p>
<p>You can specify negative value. It means that <tt class="docutils literal"><span class="pre">the</span> <span class="pre">number</span> <span class="pre">of</span> <span class="pre">groups</span> <span class="pre">+</span>
<span class="pre">drilldown_limit</span> <span class="pre">+</span> <span class="pre">1</span></tt>. For example, <tt class="docutils literal"><span class="pre">--drilldown_limit</span> <span class="pre">-1</span></tt> outputs
all groups. It's very useful value to show all groups.</p>
<p>Here is a negative <tt class="docutils literal"><span class="pre">drilldown_limit</span></tt> value example.</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown tag \
  --drilldown_sortby _key \
  --drilldown_limit -1
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;Groonga&quot;,
#         2
#       ],
#       [
#         &quot;Hello&quot;,
#         1
#       ],
#       [
#         &quot;Senna&quot;,
#         2
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command outputs all groups.</p>
<p>The default value of <tt class="docutils literal"><span class="pre">drilldown_limit</span></tt> is <tt class="docutils literal"><span class="pre">10</span></tt>.</p>
</div>
<div class="section" id="drilldown-calc-types">
<span id="select-drilldown-calc-types"></span><h4>7.3.29.4.5.6. <tt class="docutils literal"><span class="pre">drilldown_calc_types</span></tt><a class="headerlink" href="#drilldown-calc-types" title="Permalink to this headline">¶</a></h4>
<p>It specifies how to calculate (aggregate) values in grouped records by
a drilldown. You can specify multiple calculation types separated by
&quot;<tt class="docutils literal"><span class="pre">,</span></tt>&quot;. For example, <tt class="docutils literal"><span class="pre">MAX,MIN</span></tt>.</p>
<p>Calculation target values are read from a column of grouped
records. The column is specified by
<a class="reference internal" href="#select-drilldown-calc-target"><em>drilldown_calc_target</em></a>.</p>
<p>You can read calculated value by <a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> such
as <tt class="docutils literal"><span class="pre">_max</span></tt> and <tt class="docutils literal"><span class="pre">_min</span></tt> in <a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a>.</p>
<p>You can use the following calculation types:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type name</th>
<th class="head"><a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> name</th>
<th class="head">Need <a class="reference internal" href="#select-drilldown-calc-target"><em>drilldown_calc_target</em></a></th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">NONE</span></tt></td>
<td>Nothing.</td>
<td>Not needs.</td>
<td>Just ignored.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">COUNT</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_nsubrecs</span></tt></td>
<td>Not needs.</td>
<td>Counting grouped records. It's always enabled. So you don't
specify it.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">MAX</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_max</span></tt></td>
<td>Needs.</td>
<td>Finding the maximum integer value from integer values in
grouped records.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">MIN</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_min</span></tt></td>
<td>Needs.</td>
<td>Finding the minimum integer value from integer values in
grouped records.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">SUM</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_sum</span></tt></td>
<td>Needs.</td>
<td>Summing integer values in grouped records.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">AVG</span></tt></td>
<td><tt class="docutils literal"><span class="pre">_avg</span></tt></td>
<td>Needs.</td>
<td>Averaging integer/float values in grouped records.</td>
</tr>
</tbody>
</table>
<p>Here is a <tt class="docutils literal"><span class="pre">MAX</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit -1 \
  --output_column _id,n_likes \
  --drilldown tag \
  --drilldown_calc_types MAX \
  --drilldown_calc_target n_likes \
  --drilldown_output_columns _key,_max
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_max&quot;,
#           &quot;Int64&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         5
#       ],
#       [
#         &quot;Groonga&quot;,
#         15
#       ],
#       [
#         &quot;Senna&quot;,
#         3
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command groups all records by <tt class="docutils literal"><span class="pre">tag</span></tt> column value,
finding the maximum <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value for each group and
outputs pairs of grouped key and the maximum <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value
for the group. It uses <tt class="docutils literal"><span class="pre">_max</span></tt> <a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> to
read the maximum <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">MIN</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit -1 \
  --output_column _id,n_likes \
  --drilldown tag \
  --drilldown_calc_types MIN \
  --drilldown_calc_target n_likes \
  --drilldown_output_columns _key,_min
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_min&quot;,
#           &quot;Int64&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         5
#       ],
#       [
#         &quot;Groonga&quot;,
#         10
#       ],
#       [
#         &quot;Senna&quot;,
#         3
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command groups all records by <tt class="docutils literal"><span class="pre">tag</span></tt> column value,
finding the minimum <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value for each group and
outputs pairs of grouped key and the minimum <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value
for the group. It uses <tt class="docutils literal"><span class="pre">_min</span></tt> <a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> to
read the minimum <tt class="docutils literal"><span class="pre">n_likes</span></tt> column value.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">SUM</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit -1 \
  --output_column _id,n_likes \
  --drilldown tag \
  --drilldown_calc_types SUM \
  --drilldown_calc_target n_likes \
  --drilldown_output_columns _key,_sum
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_sum&quot;,
#           &quot;Int64&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         5
#       ],
#       [
#         &quot;Groonga&quot;,
#         25
#       ],
#       [
#         &quot;Senna&quot;,
#         6
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command groups all records by <tt class="docutils literal"><span class="pre">tag</span></tt> column value,
sums all <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values for each group and outputs pairs
of grouped key and the summed <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values for the
group. It uses <tt class="docutils literal"><span class="pre">_sum</span></tt> <a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> to read the
summed <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values.</p>
<p>Here is a <tt class="docutils literal"><span class="pre">AVG</span></tt> example:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit -1 \
  --output_column _id,n_likes \
  --drilldown tag \
  --drilldown_calc_types AVG \
  --drilldown_calc_target n_likes \
  --drilldown_output_columns _key,_avg
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_avg&quot;,
#           &quot;Float&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         5.0
#       ],
#       [
#         &quot;Groonga&quot;,
#         12.5
#       ],
#       [
#         &quot;Senna&quot;,
#         3.0
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command groups all records by <tt class="docutils literal"><span class="pre">tag</span></tt> column value,
averages all <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values for each group and outputs
pairs of grouped key and the averaged <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values for
the group. It uses <tt class="docutils literal"><span class="pre">_avg</span></tt> <a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> to read
the averaged <tt class="docutils literal"><span class="pre">n_likes</span></tt> column values.</p>
<p>Here is an example that uses all calculation types:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit -1 \
  --output_column _id,n_likes \
  --drilldown tag \
  --drilldown_calc_types MAX,MIN,SUM,AVG \
  --drilldown_calc_target n_likes \
  --drilldown_output_columns _key,_nsubrecs,_max,_min,_sum,_avg
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ],
#     [
#       [
#         3
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;_nsubrecs&quot;,
#           &quot;Int32&quot;
#         ],
#         [
#           &quot;_max&quot;,
#           &quot;Int64&quot;
#         ],
#         [
#           &quot;_min&quot;,
#           &quot;Int64&quot;
#         ],
#         [
#           &quot;_sum&quot;,
#           &quot;Int64&quot;
#         ],
#         [
#           &quot;_avg&quot;,
#           &quot;Float&quot;
#         ]
#       ],
#       [
#         &quot;Hello&quot;,
#         1,
#         5,
#         5,
#         5,
#         5.0
#       ],
#       [
#         &quot;Groonga&quot;,
#         2,
#         15,
#         10,
#         25,
#         12.5
#       ],
#       [
#         &quot;Senna&quot;,
#         2,
#         3,
#         3,
#         6,
#         3.0
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command specifies multiple calculation types separated
by &quot;<tt class="docutils literal"><span class="pre">,</span></tt>&quot; like <tt class="docutils literal"><span class="pre">MAX,MIN,SUM,AVG</span></tt>. You can use <tt class="docutils literal"><span class="pre">_nsubrecs</span></tt>
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> in
<a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a> without specifying <tt class="docutils literal"><span class="pre">COUNT</span></tt> in
<tt class="docutils literal"><span class="pre">drilldown_calc_types</span></tt>. Because <tt class="docutils literal"><span class="pre">COUNT</span></tt> is always enabled.</p>
<p>The default value of <tt class="docutils literal"><span class="pre">drilldown_calc_types</span></tt> is <tt class="docutils literal"><span class="pre">NONE</span></tt>. It means
that only <tt class="docutils literal"><span class="pre">COUNT</span></tt> is enabled. Because <tt class="docutils literal"><span class="pre">NONE</span></tt> is just ignored and
<tt class="docutils literal"><span class="pre">COUNT</span></tt> is always enabled.</p>
</div>
<div class="section" id="drilldown-calc-target">
<span id="select-drilldown-calc-target"></span><h4>7.3.29.4.5.7. <tt class="docutils literal"><span class="pre">drilldown_calc_target</span></tt><a class="headerlink" href="#drilldown-calc-target" title="Permalink to this headline">¶</a></h4>
<p>It specifies the target column for <a class="reference internal" href="#select-drilldown-calc-types"><em>drilldown_calc_types</em></a>.</p>
<p>If you specify a calculation type that needs a target column such as
<tt class="docutils literal"><span class="pre">MAX</span></tt> in <a class="reference internal" href="#select-drilldown-calc-types"><em>drilldown_calc_types</em></a> but you omit
<tt class="docutils literal"><span class="pre">drilldown_calc_target</span></tt>, the calculation result is always <tt class="docutils literal"><span class="pre">0</span></tt>.</p>
<p>You can specify only one column name like <tt class="docutils literal"><span class="pre">--drilldown_calc_target</span>
<span class="pre">n_likes</span></tt>. You can't specify multiple column name like
<tt class="docutils literal"><span class="pre">--drilldown_calc_target</span> <span class="pre">_key,n_likes</span></tt>.</p>
<p>You can use referenced value from the target record by combining
&quot;<tt class="docutils literal"><span class="pre">.</span></tt>&quot; like <tt class="docutils literal"><span class="pre">--drilldown_calc_target</span>
<span class="pre">reference_column.nested_reference_column.value</span></tt>.</p>
<p>See <a class="reference internal" href="#select-drilldown-calc-types"><em>drilldown_calc_types</em></a> to know how to use
<tt class="docutils literal"><span class="pre">drilldown_calc_target</span></tt>.</p>
<p>The default value of <tt class="docutils literal"><span class="pre">drilldown_calc_target</span></tt> is <tt class="docutils literal"><span class="pre">null</span></tt>. It means
that no calculation target column is specified.</p>
</div>
</div>
<div class="section" id="advanced-drilldown-related-parameters">
<span id="select-advanced-drilldown-related-parameters"></span><h3>7.3.29.4.6. Advanced drilldown related parameters<a class="headerlink" href="#advanced-drilldown-related-parameters" title="Permalink to this headline">¶</a></h3>
<p>You can get multiple drilldown results by specifying multiple group
keys by <a class="reference internal" href="#select-drilldown"><em>drilldown</em></a>. But you need to use the same
configuration for all drilldowns. For example,
<a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a> is used by all drilldowns.</p>
<p>You can use a configuration for each drilldown by the following
parameters:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].sortby</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].offset</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].limit</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].calc_types</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].calc_target</span></tt></li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">${LABEL}</span></tt> is a variable. You can use the following characters for
<tt class="docutils literal"><span class="pre">${LABEL}</span></tt>:</p>
<blockquote>
<div><ul class="simple">
<li>Alphabets</li>
<li>Digits</li>
<li><tt class="docutils literal"><span class="pre">.</span></tt></li>
<li><tt class="docutils literal"><span class="pre">_</span></tt></li>
</ul>
</div></blockquote>
<p>Parameters that has the same <tt class="docutils literal"><span class="pre">${LABEL}</span></tt> value are grouped. Grouped
parameters are used for one drilldown.</p>
<p>For example, there are 2 groups for the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">--drilldown[label1].keys</span> <span class="pre">_key</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label1].output_columns</span> <span class="pre">_nsubrecs</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label2].keys</span> <span class="pre">tag</span></tt></li>
<li><tt class="docutils literal"><span class="pre">--drilldown[label2].output_columns</span> <span class="pre">_key,_nsubrecs</span></tt></li>
</ul>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">drilldown[label1].keys</span></tt> and <tt class="docutils literal"><span class="pre">drilldown[label1].output_columns</span></tt>
are grouped. <tt class="docutils literal"><span class="pre">drilldown[label2].keys</span></tt> and
<tt class="docutils literal"><span class="pre">drilldown[label2].output_columns</span></tt> are also grouped.</p>
<p>In <tt class="docutils literal"><span class="pre">label1</span></tt> group, <tt class="docutils literal"><span class="pre">_key</span></tt> is used for group key and <tt class="docutils literal"><span class="pre">_nsubrecs</span></tt>
is used for output columns.</p>
<p>In <tt class="docutils literal"><span class="pre">label2</span></tt> group, <tt class="docutils literal"><span class="pre">tag</span></tt> is used for group key and
<tt class="docutils literal"><span class="pre">_key,_nsubrecs</span></tt> is used for output columns.</p>
<p>See document for corresponding <tt class="docutils literal"><span class="pre">drilldown_XXX</span></tt> parameter to know how
to use it for the following parameters:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].sortby</span></tt>: <a class="reference internal" href="#select-drilldown-sortby"><em>drilldown_sortby</em></a></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].offset</span></tt>: <a class="reference internal" href="#select-drilldown-offset"><em>drilldown_offset</em></a></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].limit</span></tt>: <a class="reference internal" href="#select-drilldown-limit"><em>drilldown_limit</em></a></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].calc_types</span></tt>: <a class="reference internal" href="#select-drilldown-calc-types"><em>drilldown_calc_types</em></a></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].calc_target</span></tt>: <a class="reference internal" href="#select-drilldown-calc-target"><em>drilldown_calc_target</em></a></li>
</ul>
</div></blockquote>
<p>The following parameters are needed more description:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys</span></tt></li>
<li><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt></li>
</ul>
</div></blockquote>
<p>Output format is different a bit. It's also needed more description.</p>
<div class="section" id="drilldown-label-keys">
<span id="select-drilldown-label-keys"></span><h4>7.3.29.4.6.1. <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys</span></tt><a class="headerlink" href="#drilldown-label-keys" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="#select-drilldown"><em>drilldown</em></a> can specify multiple keys for multiple
drilldowns. But it can't specify multiple keys for one drilldown.</p>
<p><tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys</span></tt> can't specify multiple keys for multiple
drilldowns. But it can specify multiple keys for one drilldown.</p>
<p>You can specify multiple keys separated by &quot;<tt class="docutils literal"><span class="pre">,</span></tt>&quot;.</p>
<p>Here is an example to group by multiple keys, <tt class="docutils literal"><span class="pre">tag</span></tt> and <tt class="docutils literal"><span class="pre">n_likes</span></tt>
column values:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit -1 \
  --output_column tag,n_likes \
  --drilldown[tag.n_likes].keys tag,n_likes \
  --drilldown[tag.n_likes].output_columns _value.tag,_value.n_likes,_nsubrecs
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ],
#       [
#         1,
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         5,
#         &quot;Hello&quot;
#       ],
#       [
#         2,
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         10,
#         &quot;Groonga&quot;
#       ],
#       [
#         3,
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         15,
#         &quot;Groonga&quot;
#       ],
#       [
#         4,
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ],
#       [
#         5,
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         3,
#         &quot;Senna&quot;
#       ]
#     ],
#     {
#       &quot;tag.n_likes&quot;: [
#         [
#           4
#         ],
#         [
#           [
#             &quot;tag&quot;,
#             &quot;ShortText&quot;
#           ],
#           [
#             &quot;n_likes&quot;,
#             &quot;UInt32&quot;
#           ],
#           [
#             &quot;_nsubrecs&quot;,
#             &quot;Int32&quot;
#           ]
#         ],
#         [
#           &quot;Hello&quot;,
#           5,
#           1
#         ],
#         [
#           &quot;Groonga&quot;,
#           10,
#           1
#         ],
#         [
#           &quot;Groonga&quot;,
#           15,
#           1
#         ],
#         [
#           &quot;Senna&quot;,
#           3,
#           2
#         ]
#       ]
#     }
#   ]
# ]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">tag.n_likes</span></tt> is used as the label for the drilldown parameters
group. You can refer grouped keys by <tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax in
<a class="reference internal" href="#select-drilldown-label-output-columns"><em>drilldown[${LABEL}].output_columns</em></a>. <tt class="docutils literal"><span class="pre">${KEY_NAME}</span></tt> is a
column name to be used by group key. <tt class="docutils literal"><span class="pre">tag</span></tt> and <tt class="docutils literal"><span class="pre">n_likes</span></tt> are
<tt class="docutils literal"><span class="pre">${KEY_NAME}</span></tt> in this case.</p>
<p>Note that you can't use <tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax when you just
specify one key as <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys</span></tt> like <tt class="docutils literal"><span class="pre">--drilldown[tag].keys</span>
<span class="pre">tag</span></tt>. You should use <tt class="docutils literal"><span class="pre">_key</span></tt> for the case. It's the same rule in
<a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a>.</p>
</div>
<div class="section" id="drilldown-label-output-columns">
<span id="select-drilldown-label-output-columns"></span><h4>7.3.29.4.6.2. <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt><a class="headerlink" href="#drilldown-label-output-columns" title="Permalink to this headline">¶</a></h4>
<p>It's almost same as <a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a>. The
difference between <a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a> and
<tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt> is how to refer group keys.</p>
<p><a class="reference internal" href="#select-drilldown-output-columns"><em>drilldown_output_columns</em></a> uses <tt class="docutils literal"><span class="pre">_key</span></tt>
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> to refer group
key. <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt> also uses <tt class="docutils literal"><span class="pre">_key</span></tt>
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> to refer group key when you specify
only one group key by <a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a>.</p>
<p>Here is an example to refer single group key by <tt class="docutils literal"><span class="pre">_key</span></tt>
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a>:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown[tag.n_likes].keys tag,n_likes \
  --drilldown[tag.n_likes].output_columns _value.tag,_value.n_likes
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     {
#       &quot;tag.n_likes&quot;: [
#         [
#           4
#         ],
#         [
#           [
#             &quot;tag&quot;,
#             &quot;ShortText&quot;
#           ],
#           [
#             &quot;n_likes&quot;,
#             &quot;UInt32&quot;
#           ]
#         ],
#         [
#           &quot;Hello&quot;,
#           5
#         ],
#         [
#           &quot;Groonga&quot;,
#           10
#         ],
#         [
#           &quot;Groonga&quot;,
#           15
#         ],
#         [
#           &quot;Senna&quot;,
#           3
#         ]
#       ]
#     }
#   ]
# ]
</pre></div>
</div>
<p>But you can't refer each group key by <tt class="docutils literal"><span class="pre">_key</span></tt>
<a class="reference internal" href="../columns/pseudo.html"><em>Pseudo column</em></a> in
<tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt>. You need to use
<tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax. <tt class="docutils literal"><span class="pre">${KEY_NAME}</span></tt> is a column name that is
used for group key in <a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a>.</p>
<p>Here is an example to refer each group key in multiple group keys by
<tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --limit 0 \
  --output_column _id \
  --drilldown[tag.n_likes].keys tag,n_likes \
  --drilldown[tag.n_likes].output_columns _value.tag,_value.n_likes
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_id&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;n_likes&quot;,
#           &quot;UInt32&quot;
#         ],
#         [
#           &quot;tag&quot;,
#           &quot;ShortText&quot;
#         ]
#       ]
#     ],
#     {
#       &quot;tag.n_likes&quot;: [
#         [
#           4
#         ],
#         [
#           [
#             &quot;tag&quot;,
#             &quot;ShortText&quot;
#           ],
#           [
#             &quot;n_likes&quot;,
#             &quot;UInt32&quot;
#           ]
#         ],
#         [
#           &quot;Hello&quot;,
#           5
#         ],
#         [
#           &quot;Groonga&quot;,
#           10
#         ],
#         [
#           &quot;Groonga&quot;,
#           15
#         ],
#         [
#           &quot;Senna&quot;,
#           3
#         ]
#       ]
#     }
#   ]
# ]
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p>Why <tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax?</p>
<p>It's implementation specific information.</p>
<p><tt class="docutils literal"><span class="pre">_key</span></tt> is a vector value. The vector value is consists of all
group keys. You can see byte sequence of the vector value by
referring <tt class="docutils literal"><span class="pre">_key</span></tt> in <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt>.</p>
<p>There is one grouped record in <tt class="docutils literal"><span class="pre">_value</span></tt> to refer each grouped
values when you specify multiple group keys to
<a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a>. So you can refer each group key
by <tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax.</p>
<p class="last">On the other hand, there is no grouped record in <tt class="docutils literal"><span class="pre">_value</span></tt> when
you specify only one group key to
<a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a>. So you can't refer group key by
<tt class="docutils literal"><span class="pre">_value.${KEY_NAME}</span></tt> syntax.</p>
</div>
</div>
<div class="section" id="output-format-for-drilldown-label-style">
<span id="select-drilldown-label-output-format"></span><h4>7.3.29.4.6.3. Output format for <tt class="docutils literal"><span class="pre">drilldown[${LABEL}]</span></tt> style<a class="headerlink" href="#output-format-for-drilldown-label-style" title="Permalink to this headline">¶</a></h4>
<p>There is a difference in output format between <a class="reference internal" href="#select-drilldown"><em>drilldown</em></a>
and <a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a>. <a class="reference internal" href="#select-drilldown"><em>drilldown</em></a> uses
array to output multiple drilldown results.
<a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a> uses pairs of label and drilldown
result.</p>
<p><a class="reference internal" href="#select-drilldown"><em>drilldown</em></a> uses the following output format:</p>
<div class="highlight-none"><div class="highlight"><pre>[
  HEADER,
  [
    SEARCH_RESULT,
    DRILLDOWN_RESULT1,
    DRILLDOWN_RESULT2,
    ...
  ]
]
</pre></div>
</div>
<p><a class="reference internal" href="#select-drilldown-label-keys"><em>drilldown[${LABEL}].keys</em></a> uses the following output format:</p>
<div class="highlight-none"><div class="highlight"><pre>[
  HEADER,
  [
    SEARCH_RESULT,
    {
      &quot;LABEL1&quot;: DRILLDOWN_RESULT1,
      &quot;LABEL2&quot;: DRILLDOWN_RESULT2,
      ...
    }
  ]
]
</pre></div>
</div>
</div>
</div>
<div class="section" id="cache-related-parameter">
<h3>7.3.29.4.7. Cache related parameter<a class="headerlink" href="#cache-related-parameter" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cache">
<h4>7.3.29.4.7.1. <tt class="docutils literal"><span class="pre">cache</span></tt><a class="headerlink" href="#cache" title="Permalink to this headline">¶</a></h4>
<p>TODO: write in English and add example.</p>
<p>クエリキャッシュに関する動作を設定します。</p>
<p><tt class="docutils literal"><span class="pre">no</span></tt></p>
<blockquote>
<div>検索結果をクエリキャッシュに残しません。キャッシュして再利用される可能性が低いクエリに対して用います。キャッシュ容量は有限です。有効なキャッシュが多くヒットするために、このパラメータは有効です。</div></blockquote>
</div>
</div>
<div class="section" id="score-related-parameters">
<h3>7.3.29.4.8. Score related parameters<a class="headerlink" href="#score-related-parameters" title="Permalink to this headline">¶</a></h3>
<p>There is a score related parameter, <tt class="docutils literal"><span class="pre">adjuster</span></tt>.</p>
<div class="section" id="adjuster">
<span id="select-adjuster"></span><h4>7.3.29.4.8.1. <tt class="docutils literal"><span class="pre">adjuster</span></tt><a class="headerlink" href="#adjuster" title="Permalink to this headline">¶</a></h4>
<p>It specifies one or more score adjust expressions. You need to use
<tt class="docutils literal"><span class="pre">adjuster</span></tt> with <tt class="docutils literal"><span class="pre">query</span></tt> or <tt class="docutils literal"><span class="pre">filter</span></tt>. <tt class="docutils literal"><span class="pre">adjuster</span></tt> doesn't work
with not searched request.</p>
<p>You can increase score of specific records by <tt class="docutils literal"><span class="pre">adjuster</span></tt>. You can
use <tt class="docutils literal"><span class="pre">adjuster</span></tt> to set high score for important records.</p>
<p>For example, you can use <tt class="docutils literal"><span class="pre">adjuster</span></tt> to increase score of records
that have <tt class="docutils literal"><span class="pre">groonga</span></tt> tag.</p>
<p>Here is the syntax:</p>
<div class="highlight-none"><div class="highlight"><pre>--adjuster &quot;SCORE_ADJUST_EXPRESSION1 + SCORE_ADJUST_EXPRESSION2 + ...&quot;
</pre></div>
</div>
<p>Here is the <tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> syntax:</p>
<div class="highlight-none"><div class="highlight"><pre>COLUMN @ &quot;KEYWORD&quot; * FACTOR
</pre></div>
</div>
<p>Note the following:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">COLUMN</span></tt> must be indexed.</li>
<li><tt class="docutils literal"><span class="pre">&quot;KEYWORD&quot;</span></tt> must be a string.</li>
<li><tt class="docutils literal"><span class="pre">FACTOR</span></tt> must be a positive integer.</li>
</ul>
</div></blockquote>
<p>Here is a sample <tt class="docutils literal"><span class="pre">adjuster</span></tt> usage example that uses just one
<tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt>:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --filter true \
  --adjuster &#39;content @ &quot;groonga&quot; * 5&#39; \
  --output_columns _key,content,_score
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         1
#       ],
#       [
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         6
#       ],
#       [
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         1
#       ],
#       [
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         1
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         1
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">select</span></tt> command matches all records. Then it applies
<tt class="docutils literal"><span class="pre">adjuster</span></tt>. The adjuster increases score of records that have
<tt class="docutils literal"><span class="pre">&quot;groonga&quot;</span></tt> in <tt class="docutils literal"><span class="pre">Entries.content</span></tt> column by 5. There is only one
record that has <tt class="docutils literal"><span class="pre">&quot;groonga&quot;</span></tt> in <tt class="docutils literal"><span class="pre">Entries.content</span></tt> column.  So the
record that its key is <tt class="docutils literal"><span class="pre">&quot;Groonga&quot;</span></tt> has score 6 (<tt class="docutils literal"><span class="pre">=</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">5</span></tt>).</p>
<p>You can omit <tt class="docutils literal"><span class="pre">FACTOR</span></tt>. If you omit <tt class="docutils literal"><span class="pre">FACTOR</span></tt>, it is treated as 1.</p>
<p>Here is a sample <tt class="docutils literal"><span class="pre">adjuster</span></tt> usage example that omits <tt class="docutils literal"><span class="pre">FACTOR</span></tt>:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --filter true \
  --adjuster &#39;content @ &quot;groonga&quot;&#39; \
  --output_columns _key,content,_score
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         1
#       ],
#       [
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         2
#       ],
#       [
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         1
#       ],
#       [
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         1
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         1
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">adjuster</span></tt> in the <tt class="docutils literal"><span class="pre">select</span></tt> command doesn't have <tt class="docutils literal"><span class="pre">FACTOR</span></tt>. So
the factor is treated as 1. There is only one record that has
<tt class="docutils literal"><span class="pre">&quot;groonga&quot;</span></tt> in <tt class="docutils literal"><span class="pre">Entries.content</span></tt> column. So the record that its
key is <tt class="docutils literal"><span class="pre">&quot;Groonga&quot;</span></tt> has score 2 (<tt class="docutils literal"><span class="pre">=</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">1</span></tt>).</p>
<p>Here is a sample <tt class="docutils literal"><span class="pre">adjuster</span></tt> usage example that uses multiple
<tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt>:</p>
<p>Execution example:</p>
<div class="highlight-none"><div class="highlight"><pre>select Entries \
  --filter true \
  --adjuster &#39;content @ &quot;groonga&quot; * 5 + content @ &quot;started&quot; * 3&#39; \
  --output_columns _key,content,_score
# [
#   [
#     0,
#     1337566253.89858,
#     0.000355720520019531
#   ],
#   [
#     [
#       [
#         5
#       ],
#       [
#         [
#           &quot;_key&quot;,
#           &quot;ShortText&quot;
#         ],
#         [
#           &quot;content&quot;,
#           &quot;Text&quot;
#         ],
#         [
#           &quot;_score&quot;,
#           &quot;Int32&quot;
#         ]
#       ],
#       [
#         &quot;The first post!&quot;,
#         &quot;Welcome! This is my first post!&quot;,
#         1
#       ],
#       [
#         &quot;Groonga&quot;,
#         &quot;I started to use Groonga. It&#39;s very fast!&quot;,
#         9
#       ],
#       [
#         &quot;Mroonga&quot;,
#         &quot;I also started to use Mroonga. It&#39;s also very fast! Really fast!&quot;,
#         4
#       ],
#       [
#         &quot;Good-bye Senna&quot;,
#         &quot;I migrated all Senna system!&quot;,
#         1
#       ],
#       [
#         &quot;Good-bye Tritonn&quot;,
#         &quot;I also migrated all Tritonn system!&quot;,
#         1
#       ]
#     ]
#   ]
# ]
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">adjuster</span></tt> in the <tt class="docutils literal"><span class="pre">select</span></tt> command has two
<tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> s. The final increased score is sum of
scores of these <tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> s. All
<tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> s in the <tt class="docutils literal"><span class="pre">select</span></tt> command are applied to
a record that its key is <tt class="docutils literal"><span class="pre">&quot;Groonga&quot;</span></tt>. So the final increased score
of the record is sum of scores of all <tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> s.</p>
<p>The first <tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> is <tt class="docutils literal"><span class="pre">content</span> <span class="pre">&#64;</span> <span class="pre">&quot;groonga&quot;</span> <span class="pre">*</span> <span class="pre">5</span></tt>.
It increases score by 5.</p>
<p>The second <tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> is <tt class="docutils literal"><span class="pre">content</span> <span class="pre">&#64;</span> <span class="pre">&quot;started&quot;</span> <span class="pre">*</span> <span class="pre">3</span></tt>.
It increases score by 3.</p>
<p>The final increased score is 9 (<tt class="docutils literal"><span class="pre">=</span> <span class="pre">1</span> <span class="pre">+</span> <span class="pre">5</span> <span class="pre">+</span> <span class="pre">3</span></tt>).</p>
<p>A <tt class="docutils literal"><span class="pre">SCORE_ADJUST_EXPRESSION</span></tt> has a factor for <tt class="docutils literal"><span class="pre">&quot;KEYWORD&quot;</span></tt>. This
means that increased scores of all records that has <tt class="docutils literal"><span class="pre">&quot;KEYWORD&quot;</span></tt> are
the same value. You can change increase score for each record that has
the same <tt class="docutils literal"><span class="pre">&quot;KEYWORD&quot;</span></tt>. It is useful to tune search score. See
<a class="reference internal" href="../columns/vector.html#weight-vector-column"><em>Weight vector column</em></a> for details.</p>
</div>
</div>
</div>
<div class="section" id="id7">
<h2>7.3.29.5. 返値<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>TODO: write in English and add example.</p>
<p>以下のようなjson形式で値が返却されます。</p>
<div class="highlight-none"><div class="highlight"><pre>[[リターンコード, 処理開始時間, 処理時間], [検索結果, ドリルダウン結果]]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">リターンコード</span></tt></p>
<blockquote>
<div>grn_rcに対応する数値が返されます。0(GRN_SUCCESS)以外の場合は、続いてエラー内容を示す
文字列が返されます。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">処理開始時間</span></tt></p>
<blockquote>
<div>処理を開始した時間について、1970年1月1日0時0分0秒を起点とした秒数を小数で返します。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">処理時間</span></tt></p>
<blockquote>
<div>処理にかかった秒数を返します。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">検索結果</span></tt></p>
<blockquote>
<div><p>drilldown条件が実行される前の検索結果が以下のように出力されます。:</p>
<div class="highlight-none"><div class="highlight"><pre>[[ヒット数], [[カラム名1,カラム型1],..], 検索結果1,..]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">ヒット数</span></tt></p>
<blockquote>
<div>検索条件にヒットしたレコードの数が出力されます。 <tt class="docutils literal"><span class="pre">--limit</span></tt> オプションで出力件数を制限した場合は出力するレコード数と一致しません。 <tt class="docutils literal"><span class="pre">ヒット数</span></tt> は <tt class="docutils literal"><span class="pre">--limit</span></tt> オプションに関係なく常にヒットしたレコードの数になります。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">カラム名n</span></tt></p>
<blockquote>
<div>output_columnsに指定された条件に従って、対象となるカラム名が出力されます。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">カラム型n</span></tt></p>
<blockquote>
<div>output_columnsに指定された条件に従って、対象となるカラム型が出力されます。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">検索結果n</span></tt></p>
<blockquote>
<div>output_columns, offset, limitによって指定された条件に従って各レコードの値が出力されます。</div></blockquote>
</div></blockquote>
<p><tt class="docutils literal"><span class="pre">drilldown結果</span></tt></p>
<blockquote>
<div><p>drilldown処理の結果が以下のように出力されます。:</p>
<div class="highlight-none"><div class="highlight"><pre>[[[件数], [[カラム名1,カラム型1],..], 検索結果1,..],..]
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">件数</span></tt></p>
<blockquote>
<div>drilldownに指定されたカラムの値の異なり数が出力されます。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">カラム名n</span></tt></p>
<blockquote>
<div>drilldown_output_columnsに指定された条件に従って、対象となるカラム名が出力されます。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">カラム型n</span></tt></p>
<blockquote>
<div>drilldown_output_columnsに指定された条件に従って、対象となるカラム型が出力されます。</div></blockquote>
<p><tt class="docutils literal"><span class="pre">ドリルダウン結果n</span></tt></p>
<blockquote>
<div>drilldown_output_columns, drilldown_offset, drilldown_limitによって指定された条件に従って各レコードの値が出力されます。</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="see-also">
<h2>7.3.29.6. See also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="../grn_expr/query_syntax.html"><em>Query syntax</em></a></li>
<li><a class="reference internal" href="../grn_expr/script_syntax.html"><em>Script syntax</em></a></li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">7.3.29. <tt class="docutils literal"><span class="pre">select</span></tt></a><ul>
<li><a class="reference internal" href="#summary">7.3.29.1. Summary</a></li>
<li><a class="reference internal" href="#syntax">7.3.29.2. Syntax</a></li>
<li><a class="reference internal" href="#usage">7.3.29.3. Usage</a><ul>
<li><a class="reference internal" href="#simple-usage">7.3.29.3.1. Simple usage</a></li>
<li><a class="reference internal" href="#search-conditions">7.3.29.3.2. Search conditions</a><ul>
<li><a class="reference internal" href="#search-condition-query">7.3.29.3.2.1. Search condition: <tt class="docutils literal"><span class="pre">query</span></tt></a></li>
<li><a class="reference internal" href="#search-condition-filter">7.3.29.3.2.2. Search condition: <tt class="docutils literal"><span class="pre">filter</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#paging">7.3.29.3.3. Paging</a></li>
<li><a class="reference internal" href="#the-total-number-of-records">7.3.29.3.4. The total number of records</a></li>
<li><a class="reference internal" href="#drilldown">7.3.29.3.5. Drilldown</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters">7.3.29.4. Parameters</a><ul>
<li><a class="reference internal" href="#required-parameter">7.3.29.4.1. Required parameter</a><ul>
<li><a class="reference internal" href="#table">7.3.29.4.1.1. <tt class="docutils literal"><span class="pre">table</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#search-related-parameters">7.3.29.4.2. Search related parameters</a><ul>
<li><a class="reference internal" href="#match-columns">7.3.29.4.2.1. <tt class="docutils literal"><span class="pre">match_columns</span></tt></a></li>
<li><a class="reference internal" href="#query">7.3.29.4.2.2. <tt class="docutils literal"><span class="pre">query</span></tt></a></li>
<li><a class="reference internal" href="#filter">7.3.29.4.2.3. <tt class="docutils literal"><span class="pre">filter</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-search-parameters">7.3.29.4.3. Advanced search parameters</a><ul>
<li><a class="reference internal" href="#match-escalation-threshold">7.3.29.4.3.1. <tt class="docutils literal"><span class="pre">match_escalation_threshold</span></tt></a></li>
<li><a class="reference internal" href="#query-expansion">7.3.29.4.3.2. <tt class="docutils literal"><span class="pre">query_expansion</span></tt></a></li>
<li><a class="reference internal" href="#query-flags">7.3.29.4.3.3. <tt class="docutils literal"><span class="pre">query_flags</span></tt></a></li>
<li><a class="reference internal" href="#query-expander">7.3.29.4.3.4. <tt class="docutils literal"><span class="pre">query_expander</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#output-related-parameters">7.3.29.4.4. Output related parameters</a><ul>
<li><a class="reference internal" href="#output-columns">7.3.29.4.4.1. <tt class="docutils literal"><span class="pre">output_columns</span></tt></a></li>
<li><a class="reference internal" href="#sortby">7.3.29.4.4.2. <tt class="docutils literal"><span class="pre">sortby</span></tt></a></li>
<li><a class="reference internal" href="#offset">7.3.29.4.4.3. <tt class="docutils literal"><span class="pre">offset</span></tt></a></li>
<li><a class="reference internal" href="#limit">7.3.29.4.4.4. <tt class="docutils literal"><span class="pre">limit</span></tt></a></li>
<li><a class="reference internal" href="#scorer">7.3.29.4.4.5. <tt class="docutils literal"><span class="pre">scorer</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#drilldown-related-parameters">7.3.29.4.5. Drilldown related parameters</a><ul>
<li><a class="reference internal" href="#select-drilldown">7.3.29.4.5.1. <tt class="docutils literal"><span class="pre">drilldown</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-sortby">7.3.29.4.5.2. <tt class="docutils literal"><span class="pre">drilldown_sortby</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-output-columns">7.3.29.4.5.3. <tt class="docutils literal"><span class="pre">drilldown_output_columns</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-offset">7.3.29.4.5.4. <tt class="docutils literal"><span class="pre">drilldown_offset</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-limit">7.3.29.4.5.5. <tt class="docutils literal"><span class="pre">drilldown_limit</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-calc-types">7.3.29.4.5.6. <tt class="docutils literal"><span class="pre">drilldown_calc_types</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-calc-target">7.3.29.4.5.7. <tt class="docutils literal"><span class="pre">drilldown_calc_target</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-drilldown-related-parameters">7.3.29.4.6. Advanced drilldown related parameters</a><ul>
<li><a class="reference internal" href="#drilldown-label-keys">7.3.29.4.6.1. <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].keys</span></tt></a></li>
<li><a class="reference internal" href="#drilldown-label-output-columns">7.3.29.4.6.2. <tt class="docutils literal"><span class="pre">drilldown[${LABEL}].output_columns</span></tt></a></li>
<li><a class="reference internal" href="#output-format-for-drilldown-label-style">7.3.29.4.6.3. Output format for <tt class="docutils literal"><span class="pre">drilldown[${LABEL}]</span></tt> style</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cache-related-parameter">7.3.29.4.7. Cache related parameter</a><ul>
<li><a class="reference internal" href="#cache">7.3.29.4.7.1. <tt class="docutils literal"><span class="pre">cache</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#score-related-parameters">7.3.29.4.8. Score related parameters</a><ul>
<li><a class="reference internal" href="#adjuster">7.3.29.4.8.1. <tt class="docutils literal"><span class="pre">adjuster</span></tt></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id7">7.3.29.5. 返値</a></li>
<li><a class="reference internal" href="#see-also">7.3.29.6. See also</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ruby_load.html"
                        title="previous chapter">7.3.28. <tt class="docutils literal"><span class="pre">ruby_load</span></tt></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="shutdown.html"
                        title="next chapter">7.3.30. <tt class="docutils literal"><span class="pre">shutdown</span></tt></a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../sources/reference/commands/select.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="shutdown.html" title="7.3.30. shutdown"
             >next</a> |</li>
        <li class="right" >
          <a href="ruby_load.html" title="7.3.28. ruby_load"
             >previous</a> |</li>
        <li><a href="../../index.html">Groonga v4.10 documentation</a> &raquo;</li>
          <li><a href="../../reference.html" >7. Reference manual</a> &raquo;</li>
          <li><a href="../command.html" >7.3. Command</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009-2015, Brazil, Inc.
    </div>
      <script src="http://connect.facebook.net/en_US/all.js"></script>

    <script>
      FB.init({
         appId  : null,
         status : true, // check login status
         cookie : true, // enable cookies to allow the server to access the session
         xfbml  : true  // parse XFBML
      });
    </script>
  </body>

</html>